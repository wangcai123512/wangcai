@{
    ViewBag.Title = "BalanceSearch";
    Layout = "~/Views/Shared/_Layout_New.cshtml";
}

<style type="text/css">
    #menu {
        font: 12px verdana, arial, sans-serif;
    }

        #menu, #menu li {
            list-style: none;
            padding: 0;
            margin: 0;
        }

            #menu li {
                float: right;
            }

                #menu li a {
                    display: block; /* 如果是中英文混排的文字，建议用固定宽度
    width:150px;
    height:30px;
    line-height:30px;
    text-align:center;
    */
                    padding: 1px 5px;
                    text-decoration: none;
                    border-left: 1px solid #000;
                }

                    #menu li a.last {
                        border-right: 0; /* 去掉左侧边框 */
                    }

    #example {
        white-space: normal;
        word-break: break-all;
        word-wrap: break-word;
    }
    
 a:link{text-decoration:none;}
 a:visited{text-decoration:none; cursor:pointer}
 a:active{text-decoration:none; cursor:pointer}
 a:hover{text-decoration:none; cursor:pointer;color: #0080ff;}

    
    .colorRed {
        /*color: rgb(125, 126, 126);*/
        /*font-size:15px;*/
        padding:0 3px 0 3px;
    }
</style>
<div id="main" style="margin-top: 100px; background-color: #FFF; padding-bottom: 20px;">
   
    <!-- Start: Sidebar -->
    <aside id="sidebar_left" style="font-size: 16px;">
        <div class="sidebar-menu" style="margin-top: 10px">
            <ul class="nav">
                <li><span class="sidebar-title" style="font-size: 14px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我的公司：<a onclick="javascript:window.location = '/CompanyInformationSet/Index'" href="javascript:window.location = '/CompanyInformationSet/Index'"><span class="sidebar-title" style="font-size: 14px; color: #023A85"><b>@Session["CompanyName"]</b></span></a></span></li>
                <li><span class="sidebar-title" style="font-size: 14px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;财务统计货币：<a onclick="javascript:window.location = '/Company/ChangeCompanySetting'" href="javascript:window.location = '/Company/ChangeCompanySetting'"><span class="sidebar-title" style="font-size: 14px;color: #023A85"><b>@Session["Currency"]</b></span></a></span></li>
                <li id="UserInfo"> <a onclick="javascript: window.location = '/UserInfo/Index'" href="javascript:window.location = '/UserInfo/Index'"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">我的属性</span></a></li>
                <li> <a onclick="javascript:window.location = '/Company/ChooseAndAddCompany'" href="javascript:window.location = '/Company/ChooseAndAddCompany'"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">新增或切换公司</span></a></li>
                <li>
                    <a class="accordion-toggle" href="#sideFour"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">财务数据设置</span></a>
                    <ul id="sideFour" class="nav sub-nav">
                        <li><a onclick="javascript:window.location = '/InitialBalanceManagement/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">科目余额初始化</span></a></li>
                        <li><a onclick="javascript:window.location = '/TaxAndTaxRateSet/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">税种与税率设置</span></a></li>
                        <li><a onclick="javascript:window.location = '/CurrencyAndExchangeRateManagement/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">货币与汇率设置</span></a></li>
                        @*<li><a onclick="javascript:window.location = '/DetailManagement/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">费用类别设置</span></a></li>*@
                        <li><a onclick="javascript:window.location = '/BusinessUnitSetting/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">业务单元设置</span></a></li>
                    </ul>
                </li>

                <li> <a onclick="javascript:window.location = '/GeneralLedgerAccount/GeneralLedger'" href="javascript:window.location = '/GeneralLedgerAccount/GeneralLedger'"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px;">设置会计科目</span></a></li>
                <li>
                    <a class="accordion-toggle menu-open" href="#sideVoucher"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">科目查询</span></a>
                    <ul id="sideVoucher" class="nav sub-nav">
                        <li><a onclick="javascript: window.location = '/InitialBalanceManagement/Search'" href="javascript:window.location = '/InitialBalanceManagement/Search'"><span class="sidebar-title" style="font-size: 14px">科目流水查询</span></a></li>
                       <li class="active"><a onclick="javascript: window.location = '/InitialBalanceManagement/BalanceSearch'" href="javascript:window.location = '/InitialBalanceManagement/BalanceSearch'"><span class="sidebar-title" style="font-size: 14px;color: #08C">科目余额查询</span></a></li>
                        @*<li><a href="#"><span class="sidebar-title" style="font-size: 14px">科目余额</span></a></li>*@
                    </ul>
                </li>
                <li>
                    <a class="accordion-toggle" href="#sidecompany"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">公司登记</span></a>
                    <ul id="sidecompany" class="nav sub-nav">
                        <li> <a onclick="javascript: window.location = '/BusinessPartnerSetting/BusinessPartner'" href="javascript:window.location = '/BusinessPartnerSetting/BusinessPartner'"><span class="sidebar-title" style="font-size: 14px">往来公司登记</span></a></li>
                        <li> <a onclick="javascript: window.location = '/BusinessPartnerSetting/Index'" href="javascript:window.location = '/BusinessPartnerSetting/Index'"><span class="sidebar-title" style="font-size: 14px">往来公司查询</span></a></li>
                    </ul>
                </li>
                
                <li>
                    <a class="accordion-toggle" href="#sideTwo"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">用户管理</span></a>
                    <ul id="sideTwo" class="nav sub-nav">
                        <li><a onclick="javascript:window.location = '/UserManagement/AddUser'" href="#"><span class="sidebar-title" style="font-size: 14px">增加新用户</span></a></li>
                        <li><a onclick="javascript:window.location = '/UserManagement/UserList'" href="#"><span class="sidebar-title" style="font-size: 14px">变更用户权限</span></a></li>
                        <li><a onclick="javascript:window.location = '/UserManagement/ExchangeManager'" href="#"><span class="sidebar-title" style="font-size: 14px">变更管理者</span></a></li>
                        <li><a onclick="javascript:window.location = '/Company/EditUser'" href="#"><span class="sidebar-title" style="font-size: 14px">修改密码</span></a></li>
                    </ul>
                </li>
                
                 @*<li>
                    <a class="accordion-toggle" href="#sideVoucher"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">会计凭证</span></a>
                    <ul id="sideVoucher" class="nav sub-nav">
                        <li> <a onclick="javascript:window.location = '/VoucherQuery/VoucherRecord'" href="javascript:window.location = '/VoucherQuery/VoucherRecord'"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">新增会计凭证</span></a></li>
                        <li> <a onclick="javascript:window.location = '/VoucherQuery/Index'" href="javascript:window.location = '/VoucherQuery/Index'"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">查询会计凭证</span></a></li>
                    </ul>
                </li>*@
                
                <li> <a onclick="Undone()" href=""><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">寻求会计帮助</span></a></li>
            </ul>
        </div>
    </aside>
    <!-- Start: Content -->
    <section id="content_wrapper">
        <div id="MAIN" style="background-color: #FFF;">
            <div id="content">
            <div class="col-md-12" style="margin: auto">
                 <div class="col-md-2" style="margin: auto"></div>
                        <div class="col-md-8" style="margin: auto">
                     <div class="panel-group" id="accordion" style="margin:0" >
                            <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#accordion" href="#Assets1">
                                    资产类
                                </a>
                               @* <input type="button" value="全选" style=" border-radius: 100px;margin:0 0 0 10%;font-weight:normal;font-size:14px" onclick="CheckDetailAll(this)" />*@
                                </h4>
                                
                            </div>
                            <div id="Assets1" class="panel-collapse collapse in">
                                <div class="panel-body">
                                <form>
                                    <div class="input-group " style="margin: auto">
                                        <table id="Assets" style="font-size: 14px;margin: auto;width:330px" class="table-condensed" ></table>
                                    </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                            </div>
                     <div class="panel-group" id="accordion" style="margin:0">
                            <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#accordion" href="#Liabilities1">
                                    负债类
                                </a>
                                    @*<input type="button" value="全选" style=" border-radius: 100px;margin:0 0 0 10%;font-weight:normal;font-size:14px" onclick="CheckDetailAll(this)" />*@
                                </h4>
                            </div>
                            <div id="Liabilities1" class="panel-collapse collapse in">
                                <div class="panel-body">
                                <form>
                                    <div class="input-group " style="margin: auto">
                                        <table id="Liabilities" style="font-size: 14px;margin: auto;width:330px" class="table-condensed" >
                                       </table>
                                    </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                            </div>
                     <div class="panel-group" id="accordion" style="margin:0">
                            <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#accordion" href="#OwnerEquity1">
                                    所有者权益类
                                </a>
                                    @*<input type="button" value="全选" style=" border-radius: 100px;margin:0 0 0 1%;font-weight:normal;font-size:14px" onclick="CheckDetailAll(this)" />*@
                                </h4>
                            </div>
                            <div id="OwnerEquity1" class="panel-collapse collapse in">
                                <div class="panel-body">
                                <form>
                                    <div class="input-group " style="margin: auto">
                                        <table id="OwnerEquity" style="font-size: 14px;margin: auto;width:330px" class="table-condensed">
                                       </table>
                                    </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                            </div>
                     <div class="panel-group" id="accordion" style="margin:0">
                            <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#accordion" href="#Cost1">
                                    成本类
                                </a>
                                    @*<input type="button" value="全选" style=" border-radius: 100px;margin:0 0 0 10%;font-weight:normal;font-size:14px" onclick="CheckDetailAll(this)" />*@
                                </h4>
                            </div>
                            <div id="Cost1" class="panel-collapse collapse in">
                                <div class="panel-body">
                                <form>
                                    <div class="input-group " style="margin: auto">
                                        <table id="Cost" style="font-size: 14px;margin: auto;width:330px" class="table-condensed">
                                       </table>
                                    </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                            </div>
                     <div class="panel-group" id="accordion" style="margin:0">
                            <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#accordion" href="#IncomeStatement1">
                                    损益类
                                </a>
                                    @*<input type="button" value="全选" style=" border-radius: 100px;margin:0 0 0 10%;font-weight:normal;font-size:14px" onclick="CheckDetailAll(this)" />*@
                                </h4>
                            </div>
                            <div id="IncomeStatement1" class="panel-collapse collapse in">
                                <div class="panel-body">
                                <form>
                                    <div class="input-group " style="margin: auto">
                                        <table id="IncomeStatement" style="font-size: 14px;margin: auto;width:330px" class="table-condensed">
                                       </table>
                                    </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                            </div>
                             <div class="input-group " style="margin: auto">
                                    @*<input type="button"onclick="Select()" value="全选" style=" border-radius: 100px;"/>
                                    <input type="button"onclick="Deselect()" value="清空" style=" border-radius: 100px;"/>*@
                                </div>
                            <div class="form-group" style="margin: auto; text-align: center">
                               @* <button onclick="Submit()" type="button" style="margin-top: 20px; height: 40px; width: 20%; border-radius: 100px; font-size: 16px; border: 0px solid #c0c0c0; font-weight: bold" class="btn btn-primary">提交</button>
                                <button onclick="Back()" type="button" style="margin-top: 20px; height: 40px; width: 20%; border-radius: 100px; font-size: 16px; border: 0px solid #c0c0c0; font-weight: bold" class="btn btn-primary">返回上页</button>*@
                            </div>
                       </div>
             <div class="col-md-2" style="margin: auto">
             </div>
            </div>
        </div>
       </div>
        <br />
    </section>
</div>

<div class="modal fade" id="DetailSubject" tabindex="-1" role="dialog" aria-labelledby="AmountUsed"
    aria-hidden="true">
    <div class="modal-dialog" style="width: 400px">
        <div class="modal-content">
            <input type="hidden" value="" id="actionHandler" name="actionHandler" />
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" >
                    &times;
                </button>
                <h4 class="modal-title" id="amyModalLabel">
                   科目明细
                </h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12" style="margin-bottom: 0px;max-height:600px;width:100%;overflow-y:scroll">
                        <table id="aTable" style="font-size: 12px">
                        </table>
                   </div>
                </div>
            </div>
            <div class="modal-footer">
            
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal -->
</div>
<div class="modal fade" id="Voucher" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" style="width: 800px">
        <div class="modal-content">
            <input type="hidden" value="" id="actionHandler" name="actionHandler" />
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" >
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">
                   凭证
                </h4>
            </div>
            <div class="modal-body">
                <div class="row" style="margin-bottom: 20px">
                 <div class="col-md-12" style="margin-bottom: 5px; text-align: center"><span style="font-size: 30px; font-weight: 900; color: #000000; text-decoration: underline">记账凭证</span>
                 </div>

                    <div class="col-md-12" style="margin-bottom: 5px;">
                         <div class="col-md-4">
                         </div>
                          <div class="col-md-4" style="text-align: center">
                          <span id='VDate'></span>
                         </div>
                          <div class="col-md-4" style="text-align: center;">
                          <span>本币：@Session["Currency"] 单位：元</span>
                         </div>
                        
                    </div>
                    <div class="col-md-12" style="margin-bottom: 5px;">
                        <span>核算单位：</span>
                         @Session["FullName"]
                         <span id="num" style="float:right"></span>
                    </div>
                    <div class="col-md-12" style="margin-bottom: 10px">
                        <table id="VoucherTable" class="table table-striped table-bordered table-condensed"  style="font-size: 12px">
                        
                        </table>
                    </div>
                    <div class="col-md-12" style="margin-left:-10px">
                    <div class="col-md-2">
                        <span>财务主管:</span>
                    </div>
                    <div class="col-md-2">
                    <span>记账:</span>
                    @Session["NickName"]
                    </div>
                    <div class="col-md-2">
                     <span>复核:</span>
                   
                    </div>
                   
                    <div class="col-md-2">
                    <span>出纳:</span>
                    </div>
                    <div class="col-md-2">
                    <span>制单:</span>
                     @Session["NickName"]
                    </div>
                    <div class="col-md-2">
                    <span>经办人:</span>
                    </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" >
                    关闭
                </button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal -->
</div>
<script language="javascript" type="text/javascript">
    jQuery(document).ready(function () {
    $("#DetailSubject").on("hidden.bs.modal", function () {
            $('#aTable').bootstrapTable('destroy');
      });
      $("#Voucher").on("hidden.bs.modal", function () {
            $('#VoucherTable').bootstrapTable('destroy');
      });
        var list = $('.table-condensed');
        var id = "";
        list.each(function () {
            id = $(this).attr("id")

            $('#' + id).bootstrapTable({
                url: "/GeneralLedgerAccount/GetLAccount?Name=" + id+"&State="+"1",
                method: 'get',
                pageSize: 20,
                pageNumber: 1,
                showHeader: false,
                singleSelect: false,
                detailView: true,
//                clickToSelect: true,
//                checkOnSelect: true,
//                selectOnCheck: true,
                checkboxHeader: false,
                detailShow: false,
                icons: {
                    detailOpen: 'glyphicon-chevron-right colorRed',
                    detailClose:'glyphicon-chevron-down colorRed'
                },
                columns: [[
                { field: 'LA_GUID', align: 'left', width: '40%', formatter: LinkHandle },
                { field: 'Amount', align: 'left', width: '50%', formatter: DecimalFmter },
                //{ field: 'LA_GUID', width: '15%', align: 'right', formatter: handle },
                //{ field: 'LA_GUID', width: '27%', align: 'left', formatter: Linkhandle },
                ]],
                detailBind: function (index, row, $detail) {
                    InitDetailable(index, row, $detail);
                }
            });
        });
    });
    function InitDetailable(index, row, $detail) {
        var parentid = row.LA_GUID;
        var cur_table = $detail.html('<table></table>').find('table');
        cur_table.attr('id', parentid);
        cur_table.attr('class', 'Table2');
        cur_table.attr('style', 'margin-left:18px');
        $(cur_table).bootstrapTable({
            url: "/GeneralLedgerAccount/GetDetailLAccount",
            method: 'get',
            queryParams: { strParentID: parentid,State:"1"},
            ajaxOptions: { strParentID: parentid },
            showHeader: false,
            detailShow: false,
            //        clickToSelect: true,
            detailView: true, //父子表
            uniqueId: "DA_GUID",
            pageSize: 10,
            pageList: [10, 25],
            icons: {
                detailOpen: 'glyphicon-chevron-right colorRed',
                detailClose: 'glyphicon-chevron-down colorRed'
            },
            columns: [[
                { field: 'UinName', align: 'left', width: '40%' },
                { field: 'Amount', align: 'left', width: '50%', formatter: DecimalFmter },
               // { field: 'DA_GUID', width: '15%', formatter: handle },
//                { field: 'DA_GUID', width: '27%', align: 'left', formatter: Linkhandle1 },
             ]],
            //无线循环取子表，直到子表里面没有记录
            detailBind: function (index, row, $Subdetail) {
                InitSubTable(index, row, $Subdetail);
            },
            onLoadSuccess: function (data) {
                if (data.length == 0) {
                    $detail.parent().prev().find(".detail-icon").hide();
                    $detail.parent().hide();
                } else {
                    $detail.parent().prev().find(".detail-icon").show();
                }
            }
        });
        //if ($(cur_table).bootstrapTable("getData").length == 0) {
        //    $Subdetail.parent().prev().find(".detail-icon").hide();
        //}
    };

    function InitSubTable(index, row, $Subdetail) {
        var parentid = row.DA_GUID;
        var cur_table = $Subdetail.html('<table></table>').find('table');
        cur_table.attr('id', parentid);
        cur_table.attr('class', 'Table3');
        cur_table.attr('style', 'margin-left:40px');
        $(cur_table).bootstrapTable({
            url: "/GeneralLedgerAccount/GetThirdDetailLAccount",
            method: 'get',
            queryParams: { strParentID: parentid,State:"1" },
            ajaxOptions: { strParentID: parentid },
            //        clickToSelect: true,
            //        detailView: true, //父子表
            uniqueId: "TDA_GUID",
            showHeader: false,
            pageSize: 10,
            pageList: [10, 25],
            icons: {
                detailOpen: 'glyphicon-chevron-right colorRed',
                detailClose: 'glyphicon-chevron-down colorRed'
            },
            columns: [[
             { field: 'UinName', align: 'left', width: '40%' },
                { field: 'Amount', align: 'left', width: '50%', formatter: DecimalFmter },
//                { field: 'TDA_GUID', width: '30%', formatter: handle },
             ]],
            //        无线循环取子表，直到子表里面没有记录
            //        onExpandRow: function (index, row, $Subdetail) {
            //            InitSubTable(index, row, $Subdetail);
            //        }
            onLoadSuccess: function (data) {
                if (data.length == 0) {
                    $Subdetail.parent().prev().find(".detail-icon").hide();
                    $Subdetail.parent().hide();
                } else {
                    $Subdetail.parent().prev().find(".detail-icon").show();
                }
            }
        });
        //if ($(cur_table).bootstrapTable("getData").length == 0) {
        //    $Subdetail.parent().prev().find(".detail-icon").hide();
        //}
    };
    var LinkHandle = function (value, row, index) {
        var link = " <a class='linkbtn' style='cursor: pointer;'  onclick='GetDetail(\"" + value + "\")'>\ " + row.UinName + "\</a> ";
        return link;
    }

    var DecimalFmter = function (s) {
        if (s == null || s == "undefined" || s == '0') {
            return "";
        }
        var h = '';
        s = s.toString();
        if (s.charAt(0) == '-') {
            h = '-';
            s = s.slice(1);
        }
        if (/[^0-9\.]/.test(s)) return "NaN";
        s = s.replace(/^(\d*)$/, "$1.");
        s = (s + "00").replace(/(\d*\.\d\d)\d*/, "$1");
        s = s.replace(".", ",");
        var re = /(\d)(\d{3},)/;
        while (re.test(s)) s = s.replace(re, "$1,$2");
        s = s.replace(/,(\d\d)$/, ".$1");
        return h + s.replace(/^\./, "0.");

    }
    var DecimalFmter1 = function (s,row,index) {
        if (s == null || s == "undefined" || s == '0') {
            return "";
        }
        var h = '';
        s = s.toString();
        if (s.charAt(0) == '-') {
            h = '-';
            s = s.slice(1);
        }
        if (/[^0-9\.]/.test(s)) return "NaN";
        s = s.replace(/^(\d*)$/, "$1.");
        s = (s + "00").replace(/(\d*\.\d\d)\d*/, "$1");
        s = s.replace(".", ",");
        var re = /(\d)(\d{3},)/;
        while (re.test(s)) s = s.replace(re, "$1,$2");
        s = s.replace(/,(\d\d)$/, ".$1");
        if(row.State=="0")
        {
        return link = " <a class='linkbtn' style='cursor: pointer;'  onclick='GetDetailVou(\"" + row.V_GUID + "\")'>\ " + h + s.replace(/^\./, "0.") + "\</a> ";
        }
        if(row.State=="1"){
            return h + s.replace(/^\./, "0.");
        }
    }
    function GetDetail(value) {
        $("#aTable").bootstrapTable({
            url: "/InitialBalanceManagement/GetLDetailAccount?LA_GUID=" + value,
            method: 'get',
            pageSize: 20,
            pageNumber: 1,
            columns: [[
                { field: 'Amount', align: 'center',title:'余额', width: '50%', formatter: DecimalFmter1 },
                { field: 'createDate', align: 'left',title:'更新日期', width: '50%'},
            //{ field: 'LA_GUID', width: '15%', align: 'right', formatter: handle },
            //{ field: 'LA_GUID', width: '27%', align: 'left', formatter: Linkhandle },
                ]],
            
        });
        $('#DetailSubject').modal({ show: true, backdrop: 'static' });
         $('#DetailSubject').draggable();
         $(".boxed-layout").css("padding-right", "0px");
    }
         

//        var check =function(value,row,index){
//            if(value==null){
//                return "";
//            }if(row.Summary=="附单据数     张")
//            {
//                return ChinaCost(row.DebitAmount);
//            }
//            else{
//                if(value.toString().length ==1){
//                 VoucherID='第'+'00'+value+'号'
//                }
//                if(value.toString().length ==2){
//                 VoucherID='第'+'0'+value+'号'
//                }
//                else if(value.toString().length >2){
//                 VoucherID='第'+value+'号'
//                }
//                if(row.Flag=="E"){
//                    num="001/003";
//                }
//                 if(row.Flag=="I"){
//                    num="001/001";
//                }
//                 if(row.Flag=="R"){
//                    num="001/002";
//                }
//                 if(row.Flag=="P"){
//                    num="001/004";
//                }
//                 if(row.Flag=="DS"){
//                    num="001/005";
//                }
//                 if(row.Flag=="DC"){
//                    num="001/006";
//                }
//                VoucherID = VoucherID+'-'+num;
//            document.getElementById("num").innerText = VoucherID;
//            return  "<a class='linkbtn' style='cursor: pointer;' onclick='GetVoucher(\"" + row.GUID +'","' +row.Flag+'","' +VoucherID+ "\")'>\ " + VoucherID + "\</a>";
//            }
//        }
    function GetDetailVou(id){
//        $("#DetailSubject").modal('hide');
      $('#VoucherTable').bootstrapTable("destroy");
        $('#VoucherTable').bootstrapTable({
           url: "/VoucherQuery/GetALLVoucher?VouchGuid="+id,
            method: 'get',
            pageSize: 30,
            pageList: [10, 20, 30, 50, 100, 200], // 自定义分页列表
            pageNumber: 1,
            columns: [[
                { field: 'Summary', title: '摘要',formatter:Handle },
//                { field: 'id', title: '编号',formatter:check},
                { field: 'Date', title: '日期', formatter: DateHandle },
                { field: 'Name', title: '一级科目' ,formatter:Handle },
                { field: 'DetailName', title: '二级及明细科目',formatter:Handle1},
                //{ field: 'ThName', title: '三级科目',formatter:Handle  },
                { field: 'DebitAmount', title: '借方金额',formatter:DecimalFmter},
				{ field: 'CreditAmount', title: '贷方金额',formatter:DecimalFmter}
            ]],
        });
         
         $('#Voucher').modal({ show: true, backdrop: 'static' });
         $(".boxed-layout").css("padding-right", "0px");
         $('#Voucher').draggable();
        
    }

    var Handle1 = function(s,row,index)
    {
        if(row.Summary !=null&&row.Summary.indexOf("附单") != -1)
            {
                return ChinaCost(row.DebitAmount);
            }
        if (s == null || s == "undefined" || s=='0') {
            return "";
        }else {
            if(row.ThName == null || row.ThName == "undefined" || row.ThName=='0')
               {return s;} else{
                s = s+"-"+row.ThName;
               }
        }
        return s;
    }

        var VoucherID
        var num
        var Handle = function(s,row,index){
        if(row.id !=null){
        if(row.id.toString().length ==1){
                 VoucherID='第'+'00'+row.id+'号'
                }
                if(row.id.toString().length ==2){
                 VoucherID='第'+'0'+row.id+'号'
                }
                else if(row.id.toString().length >2){
                 VoucherID='第'+row.id+'号'
                }
//                if(row.Flag=="E"){
//                    num="001/003";
//                }
//                 if(row.Flag=="I"){
//                    num="001/001";
//                }
//                 if(row.Flag=="R"){
//                    num="001/002";
//                }
//                 if(row.Flag=="P"){
//                    num="001/004";
//                }
//                 if(row.Flag=="DS"){
//                    num="001/005";
//                }
//                 if(row.Flag=="DC"){
//                    num="001/006";
//                }
//                VoucherID = VoucherID+'-'+num;
                 document.getElementById("num").innerText = VoucherID;
                }
        if (s == null || s == "undefined" || s=='0') {
            return "";
        }
        return s;
        }


     var DateHandle = function (jsondate) {
       
        jsondate = jsondate.replace("/Date(", "").replace(")/", "");
         if (jsondate<0){
            return "";
        }  else{
        if (jsondate.indexOf("+") > 0) {
            jsondate = jsondate.substring(0, jsondate.indexOf("+"));
        } else if (jsondate.indexOf("-") > 0) {
            jsondate = jsondate.substring(0, jsondate.indexOf("-"));
        }

        var date = new Date(parseInt(jsondate, 10));
        var month = date.getMonth() + 1 < 10 ? "0" + (date.getMonth() + 1) : date.getMonth() + 1;
        var currentDate = date.getDate() < 10 ? "0" + date.getDate() : date.getDate();
        return date.getFullYear() + "/" + month + "/" + currentDate;
        }
    }
    
</script>
