@{ ViewBag.Title = "Index"; Layout = "~/Views/Shared/_Layout_New.cshtml"; }
<script type="text/javascript" src="@Url.Content("~/js/views/taxrate.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/jquery.qrcode.min.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/webuploader.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/views/PaymentClassifyAttachment.js")"></script>
<link rel="stylesheet" type="text/css" href="@Url.Content("~/css/webuploader.css")" />
<script type="text/javascript">
    var rper;
    var bussines1 = new Array();
    var bussines2 = new Array();
    var bussines3 = new Array();
    var option1 = new Array("购买商品、接受服务所支付的款", "支付销售费用", "支付管理费用", "支付财务费用", "支付其他业务成本", "支付营业外支出", "支付暂支借款", "支付押金", "归还其它公司支付的押金", "支付职工薪酬", "支付的各项税费", "预付供应商账款")
    var option2 = new Array("购买固定资产所支付的款", "购买无形资产所支付的款", "购买其他长期资产所支付的款", "短期投资支出", "长期股权投资支出", "长期债券投资支出", "支付的其他与投资活动有关的款");
    var option3 = new Array("分配利润、股利所支付的款", "归还短期借款所支付的款", "归还长期借款所支付的款", "偿付利息所支付的款", "支付的其他与筹资活动有关的款")
    var arr1 = ["购买商品、接受服务所支付的款", "支付销售费用", "支付管理费用", "支付财务费用", "支付其他业务成本", "支付营业外支出"];
    var arr2 = ["支付押金", "归还其它公司支付的押金", "归还短期借款所支付的款", "归还长期借款所支付的款", "分配利润、股利所支付的款", "偿付利息所支付的款", "购买固定资产所支付的款", "购买无形资产所支付的款", "购买其他长期资产所支付的款", "短期投资支出", "长期股权投资支出", "长期债权投资支出", "预付供应商账款"];
    var EType = ['营业成本', '管理费用', '销售费用', '财务费用', '其他业务成本', '营业外支出'];
    for (var i = 0; i < option1.length; i++) {
        var temp = new Object;
        temp.lable = i + 1;
        temp.value = option1[i];
        bussines1.push(temp);
    }
    for (var i = 0; i < option2.length; i++) {
        var temp = new Object;
        temp.lable = i + 1;
        temp.value = option2[i];
        bussines2.push(temp);
    }
    for (var i = 0; i < option3.length; i++) {
        var temp = new Object;
        temp.lable = i + 1;
        temp.value = option3[i];
        bussines3.push(temp);
    }

    $(document).ready(function () {
        TaxBind(1);
        InitalDateInput();
        $("#incomeGrp").change(function () {
            BindInvTypeDts($("#incomeGrp"), $("#InvTypeDts"));
        });


        $('#InvTypeDts').multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: true,
            includeFilterNewBtn: false,
            nonSelectedText: '请先选择付款类别'
        });
        $("#InvTypeDts").val("").multiselect("refresh");
        var Payee
        var bankaccount;


        $.ajax({
            url: "/InternalAPI/GetPayeeJson",
            async: false,
            dataType: "json",
            success: function (d) {
                rper = d;
            }
        });

        $.ajax({
            url: "/InternalAPI/GetPayeeJson",
            async: false,
            dataType: "json",
            success: function (d) {
                for (var i = 0; i < d.length; i++) {
                    d[i]["id"] = d[i]["value"];
                    d[i]["value"] = d[i]["label"];
                }
                Payee = d;
            }
        });

        $.ajax({
            url: "/InternalAPI/GetBankAccountss",
            async: false,
            dataType: "json",
            success: function (d) {

                bankaccount = d;
            }
        });
        $('#customer').multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: true,
            includeFilterNewBtn: false,
            nonSelectedText: ''
        });
        $("#customer").multiselect('dataprovider', rper);
        $("#customer").val("").multiselect("refresh");

        $('#incomeGrp').multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: false,
            includeFilterNewBtn: false,
            includeSelectAllOption: true,
            nonSelectedText: ''
        });
        $("#incomeGrp").val("").multiselect("refresh");

        $("#dateEnd").datepicker({
            language: "zh-CN",
            autoclose: true, //选中之后自动隐藏日期选择框
            clearBtn: true, //清除按钮
            todayBtn: "linked", //今日按钮
            format: "yyyy/mm/dd"//日期格式
        });

        $('#PRBankAccount').multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: true,
            includeFilterNewBtn: false,
            nonSelectedText: ''

        });

        $("#PRBankAccount").multiselect('dataprovider', bankaccount);
        $("#PRBankAccount").val("").multiselect("refresh");

        $('#PRCurrency').multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: true,
            includeFilterNewBtn: false

        });
        $("#PRCurrency").multiselect('dataprovider', currency);
        $("#PRCurrency").val("").multiselect('refresh');
        $("#PRCurrency").multiselect('select', standardCoin);

        $('#Currency').multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: true,
            includeFilterNewBtn: false

        });
        $("#Currency").multiselect('dataprovider', currency);
        $("#Currency").val("").multiselect('refresh');
        $("#Currency").multiselect('select', standardCoin);

        //        $("#Amount").blur(function () {
        //            SumAmount("#Amount", "#TaxationAmount", "#SumAmount")
        //        });
        //        $("#TaxationAmount").blur(function () {
        //            SumAmount("#Amount", "#TaxationAmount", "#SumAmount")
        //        });

        InitSelect($("#Record"), "");

        function log(message) {
            $("#Example_1 #Log").val(message);
        }
        $("#Example_1 #autocomplete").autocomplete({
            source: Payee, minLength: 0, autoFocus: false, delay: 200,
            select: function (event, ui) {
                log(ui.item.id);
            }

        }).focus(function () {
            $(this).autocomplete("search");
        });
        initFileInput("#Example_1", " #payPic");

        function log(message) {
            $("#Log1").val(message);
        }
        $("#autocomplete1").autocomplete({
            source: Payee, minLength: 0, autoFocus: false, delay: 200,
            select: function (event, ui) {
                log(ui.item.id);
            }
        }).focus(function () {
            $(this).autocomplete("search");
            //            window.location.href=document.URL;
        });
        function log(message) {
            $("#Log2").val(message);
        }
        $("#autocomplete2").autocomplete({
            source: Payee, minLength: 0, autoFocus: false, delay: 200,
            select: function (event, ui) {
                log(ui.item.id);
            }
        }).focus(function () {
            $(this).autocomplete("search");
            //            window.location.href=document.URL;
        });
        //        InitSelect($("#TaxationType"), "");


    });

    function InitSelect(obj, nonText) {
        obj.multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            maxWidth: 1,
            enableFiltering: true,
            includeFilterNewBtn: false,
            nonSelectedText: nonText

        });
        obj.val("").multiselect("refresh");
    }
    function IntiFileUpload(selector, guid) {
        //      var files = $("#certificate").fileinput('getFileStack');
        FileInputBaseSetting(selector);
        $(selector).fileinput('refresh', {
            uploadUrl: '/InternalAPI/FileUpload',
            allowedFileExtensions: ['jpg', 'png'],
            uploadExtraData: function () { // callback example
                var out = {};
                out['frGuid'] = guid;
                return out;
            }
        });
    }
    function BindInvTypeDts(invTypeObj, invTypeDtsObj) {


        invTypeDtsObj.val("");
        //清空重写

        var invtype = invTypeObj.find("option:selected").text();
        if (invtype == "全部") {
            invTypeDtsObj.multiselect('dataprovider', "");
        }
        if (invtype == "未归类") {
            invTypeDtsObj.multiselect('dataprovider', "");
        }
        if (invtype == "经营活动付款") {

            invTypeDtsObj.multiselect('dataprovider', bussines1);
        }
        if (invtype == "投资活动付款") {
            invTypeDtsObj.val("value", "");
            invTypeDtsObj.multiselect('dataprovider', bussines2);
        }
        if (invtype == "筹资活动付款") {
            invTypeDtsObj.val("value", "");
            invTypeDtsObj.multiselect('dataprovider', bussines3);
        }
        invTypeDtsObj.multiselect('refresh');
    }
</script>
<div id="main" style="margin-top: 100px;">
    <aside id="sidebar_left" style="font-size: 16px;">
        <div class="sidebar-menu" style="margin-top: 10px">
            <ul class="nav" style="">
                <li> <a onclick="javascript:window.location = '/Common/Index'" href="javascript:window.location = '/Common/Index'"><span class="sidebar-title" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px;font-weight:bold">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;首页</span></a></li>
                <li>
                    <a onclick="javascript:window.location = '/PaymentRecord/PaymentRecord'" href="javascript:window.location = '/PaymentRecord/PaymentRecord'">
                        <span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span>
                        <span class="sidebar-title" style="font-size: 14px;">记录付款</span> <span class="sidebar-title-tray"></span>
                    </a>
                </li>
                @* <li>

                    <a  onclick="javascript:window.location = '/PaymentWrite/Index'" href="javascript:window.location = '/PaymentWrite/Index'" >
                       <span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span>
                       <span class="sidebar-title" style="font-size: 14px;">付款销账</span> <span class="sidebar-title-tray"></span>
                    </a>
                    </li> *@

                <li class="active">

                    <a onclick="javascript:window.location = '/PaymentClassify/Index?page=1&rows=10'" href="javascript:window.location = '/PaymentClassify/Index?page=1&rows=10'">
                        <span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span>
                        <span class="sidebar-title" style="font-size: 14px; color: #08C">查询付款与销账</span> <span class="sidebar-title-tray"></span>
                    </a>
                </li>
                <li>

                    <a onclick="javascript:window.location = '/PaymentDeclareCostSpending/Index'" href="javascript:window.location = '/PaymentDeclareCostSpending/Index'">
                        <span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span>
                        <span class="sidebar-title" style="font-size: 14px;">申请成本外支出</span> <span class="sidebar-title-tray"></span>
                    </a>
                </li>

                <li>

                    <a onclick="javascript:window.location = '/PaymentDeclareCostSpendingQuery/Query'" href="javascript:window.location = '/PaymentDeclareCostSpendingQuery/Query'">
                        <span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span>
                        <span class="sidebar-title" style="font-size: 14px;">查询成本外支出</span> <span class="sidebar-title-tray"></span>
                    </a>
                </li>
            </ul>
        </div>
    </aside>
    <!-- Start: Content -->
    <section id="content_wrapper">
        <div id="MAIN" style="background-color: #FFF">
            <div id="content" onclick="removeClass()">
                <div class="row" style="margin-top: 20px;height:2500px">
                    <div class="col-md-12" style="margin-bottom: 20px; text-align: center"><span style="font-size: 30px; font-weight: 900; color: #074592; text-decoration: underline">查询付款与销账</span></div>
                    <div class="col-md-12" style="margin: auto">
                        <div class="panel panel-visible">
                            <div class="panel-body pbn">
                                <div id="toolbar">
                                    <div class="col-md-12" style="margin-bottom: 0px">
                                        <form>
                                            <div class="col-md-6" style="margin-bottom: 0px">
                                                <div class="col-md-7" style="margin-bottom: 0px">
                                                    <div class="form-group" style="margin-top: 0px">
                                                        <div class="input-group input-group-sm" style="margin: 0">
                                                            <span class="input-group-addon" style="color: #000000;">付款日期</span>
                                                            <input type="text" id="dateBegin" name="dateBegin" class="form-control datepicker mtn" required="" />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-1" style="margin-bottom: 0px">
                                                    至
                                                </div>
                                                <div class="col-md-4" style="margin-bottom: 0px">
                                                    <div class="form-group" style="margin-top: 0px">
                                                        <div class="input-group input-group-sm" style="margin: 0">
                                                            <input type="text" id="dateEnd" name="dateEnd" class="form-control" required="" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6" style="margin-bottom: 0px">
                                                <div class="col-md-12" style="margin-bottom: 0px">
                                                    <div class="form-group" style="margin-top: 0px">
                                                        <div class="input-group input-group-sm" style="margin: 0">
                                                            <span class="input-group-addon" style="color: #000000;">收款方&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                            <select id="customer" name="customer" required="true"></select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-6" style="margin-bottom: 0px">
                                                <div class="col-md-12" style="margin-bottom: 0px">
                                                    <div class="form-group">
                                                        <div class="input-group input-group-sm" style="margin: 0">
                                                            <span class="input-group-addon" style="color: #000000;">付款类别 </span>
                                                            <select id="incomeGrp" name="incomeGrp">
                                                                <option value="">全部</option>
                                                                <option value="未归类">未归类</option>
                                                                <option value="经营活动付款">经营活动付款</option>
                                                                <option value="投资活动付款">投资活动付款</option>
                                                                <option value="筹资活动付款">筹资活动付款</option>

                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6" style="margin-bottom: 0px">
                                                <div class="col-md-12" style="margin-bottom: 0px">
                                                    <div class="form-group" style="margin-top: 0px">
                                                        <div class="input-group input-group-sm" style="margin: 0">
                                                            <span class="input-group-addon" style="color: #000000;">付款子类别</span>
                                                            <select id="InvTypeDts" name="InvTypeDts" required="true"></select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6" style="margin-bottom: 0px">
                                                <div class="col-md-12" style="margin-bottom: 0px">
                                                    <div class="form-group" style="margin-top: 0px">
                                                        <div class="input-group input-group-sm" style="margin: 0">
                                                            <span class="input-group-addon" style="color: #000000;">销账状态</span>
                                                            <select id="Record" name="Record" required="true">
                                                                <option value="">全部</option>
                                                                <option value="未销账">未销账</option>
                                                                <option value="已销账">已销账</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>



                                            <div class="col-md-12" style="margin-bottom: 0px">
                                                <div class="col-md-5" style="margin: auto">
                                                </div>
                                                <div class="col-md-2" style="margin: auto">
                                                    <button onclick="query()" type="button" style="width: 100px; border-radius: 100px; font-size: 12px; border: 0px solid #c0c0c0; font-weight: bold" class="btn btn-primary">查询</button>
                                                </div>
                                                <div class="col-md-5" style="margin: auto">
                                                    <button onclick="javascript:window.location ='/Common/Index'" type="button" style="width: 100px;
                                                      border-radius: 100px; font-size: 12px; border: 0px solid #c0c0c0; font-weight: bold"
                                                            class="btn btn-primary pull-right">
                                                        返回上页
                                                    </button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <table id="PayList" style="font-size: 12px" class="table-condensed"></table>
                                <br />
                                <div class="col-md-12" style="margin: auto">
                                    <button type="button" id="guizhang" style="width: 100px; border-radius: 100px; font-size: 14px; border: 0px solid #c0c0c0; font-weight: bold"
                                            class="btn btn-primary pull-left" onclick='ShowModel(this)'>
                                        销账付款
                                    </button>
                                    <br /><br /><br />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
<div class="modal fade" id="amyModal" tabindex="-1" role="dialog" aria-labelledby="amyModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" style="width: 800px">
        <div class="modal-content">
            <input type="hidden" value="" id="actionHandler" name="actionHandler" />
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" onclick="close()" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="amyModalLabel">
                    销账付款
                </h4>
            </div>
            <div class="modal-body">
                @*<iframe id="editform" width="100%" height="50%" frameborder="0"></iframe>*@
                <div class="row" id="model_table" style="display: none">
                    <div class="col-md-12" style="margin-bottom: 0px">
                        <table id="aTable" style="font-size: 12px"></table>
                    </div>
                </div>
                <div class="row" id="btDiv">
                    <div class="col-md-12" id="b1" name="bt" style="margin-bottom: 0px;display:none">
                        <div class="col-md-2" style="margin:auto">
                        </div>
                        <div class="col-md-10" style="margin-right:-200px">
                            <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px; border: 0px solid #c0c0c0; font-weight: bold;"
                                    class="btn btn-primary pull-right" value='购买商品、接受服务所支付的款' onclick='REClick0(value)'>
                                显示全部
                            </button>
                            <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                                border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                value='营业成本' onclick='RE1Click(value)'>
                                计入营业成本
                            </button>
                            <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                                border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                onclick=''>
                                计入库存商品
                            </button>
                        </div>
                    </div>
                    <div class="col-md-12" id="b12" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='支付管理费用' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='管理费用' onclick='RE1Click(value)'>
                            计入管理费用
                        </button>
                    </div>
                    <div class="col-md-12" id="b13" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='支付销售费用' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='销售费用' onclick='RE1Click(value)'>
                            计入销售费用
                        </button>
                    </div>
                    <div class="col-md-12" id="b14" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='支付其他业务成本' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='其他业务成本' onclick='RE1Click(value)'>
                            计入其他业务成本
                        </button>
                    </div>
                    <div class="col-md-12" id="b15" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='支付营业外支出' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='营业外支出' onclick='RE1Click(value)'>
                            计入营业外支出
                        </button>
                    </div>
                    <div class="col-md-12" id="b2" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='支付押金' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='支付押金' onclick='RE2Click(value)'>
                            计入押金
                        </button>
                    </div>
                    <div class="col-md-12" id="b16" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='偿付利息所支付的款' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='偿付利息所支付的款' onclick='RE2Click(value)'>
                            计入偿付利息
                        </button>
                    </div>
                    <div class="col-md-12" id="b17" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='支付暂支借款' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='支付暂支借款' onclick='RE2Click(value)'>
                            计入暂支借款
                        </button>
                    </div>
                    <div class="col-md-12" id="b18" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='归还其它公司支付的押金' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 200px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='归还其它公司支付的押金' onclick='RE2Click(value)'>
                            计入归还其它公司支付的押金
                        </button>
                    </div>
                    <div class="col-md-12" id="b3" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" 
                            class="btn btn-primary pull-right" value='支付职工薪酬' onclick='REClick0(value)'> 显示全部
                        </button>
                            <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                                border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                onclick='RE1Click()'>
                                计入职工薪酬
                            </button>
                    </div>
                    <div class="col-md-12" id="b4" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" 
                            class="btn btn-primary pull-right" value='预付供应商账款' onclick='REClick0(value)'> 显示全部
                        </button>
                            <button type="button" style="width: 130px; border-radius: 100px; font-size: 10px;
                                border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                value='预付供应商账款' onclick='RE2Click(value)'>
                                计入预付供应商账款
                            </button>
                    </div>
                    <div class="col-md-12" id="b5" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='支付的各项税费' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            onclick='RE1Click()'>
                            计入税费
                        </button>
                    </div>
                    <div class="col-md-12" id="b6" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right" value='短期投资支出' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 150px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='短期投资支出' onclick='RE2Click(value)'>
                            计入短期投资支出
                        </button>
                    </div>
                    <div class="col-md-12" id="b21" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='长期股权投资支出' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 200px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='长期股权投资支出' onclick='RE2Click(value)'>
                            计入长期股权投资支出
                        </button>
                    </div>
                    <div class="col-md-12" id="b22" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='长期债券投资支出' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 200px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='长期债券投资支出' onclick='RE2Click(value)'>
                            计入长期债券投资支出
                        </button>
                    </div>
                    <div class="col-md-12" id="b7" name="bt" style="margin-bottom: 0px; display: none">
                        <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='购买固定资产所支付的款' onclick='REClick0(value)'>
                            显示全部
                        </button>
                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                            value='购买固定资产所支付的款' onclick='RE2Click(value)'>
                            计入固定资产
                        </button>
                    </div>
                    <div class="col-md-12" id="b7" name="bt" style="margin-bottom: 0px; display: none">
                        <div class="col-md-12" id="b19" name="bt" style="margin-bottom: 0px; display: none">
                            <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                                border: 0px solid #c0c0c0; font-weight: bold;" 
                                class="btn btn-primary pull-right" value='购买无形资产所支付的款' onclick='REClick0(value)'>
                                显示全部
                            </button>
                                <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                                    border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                    value='购买无形资产所支付的款' onclick='RE2Click(value)'>
                                    计入无形资产
                                </button>
                        </div>
                        <div class="col-md-12" id="b20" name="bt" style="margin-bottom: 0px; display: none">
                            <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                                border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                value='购买其他长期资产所支付的款' onclick='REClick0(value)'>
                                显示全部
                            </button>
                            <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                                border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                value='购买其他长期资产所支付的款' onclick='RE2Click(value)'>
                                计入其他长期资产
                            </button>
                        </div>
                                <div class="col-md-12" id="b8" name="bt" style="margin-bottom: 0px; display: none">
                                    <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                                        border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                        value='归还短期借款所支付的款' onclick='REClick0(value)'>
                                        显示全部
                                    </button>
                                    <button type="button" style="width: 150px; border-radius: 100px; font-size: 10px;
                                        border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                        value='归还短期借款所支付的款' onclick='RE2Click(value)'>
                                        计入归还短期借款
                                    </button>
                                </div>
                                <div class="col-md-12" id="b23" name="bt" style="margin-bottom: 0px; display: none">
                                    <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                                        border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                        value='归还长期借款所支付的款' onclick='REClick0(value)'>
                                        显示全部
                                    </button>
                                    <button type="button" style="width: 150px; border-radius: 100px; font-size: 10px;
                                        border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                        value='归还长期借款所支付的款' onclick='RE2Click(value)'>
                                        计入归还长期借款
                                    </button>
                                </div>
                                <div class="col-md-12" id="b9" name="bt" style="margin-bottom: 0px; display: none">
                                    <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                                        border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                        value='分配股利、利润的款' onclick='REClick0(value)'>
                                        class="btn btn-primary pull-right" value='分配利润、股利所支付的款' onclick='REClick0(value)'>
                                        显示全部
                                    </button>
                                        <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                                            border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                            value='分配利润、股利所支付的款' onclick='RE2Click(value)'>
                                            计入股利、利润
                                        </button>
                                </div>
                                <div class="col-md-12" id="b10" name="bt" style="margin-bottom: 0px; display: none">
                                    <button type="button" name="all1" style="width: 100px; border-radius: 100px; font-size: 10px;
                                        border: 0px solid #c0c0c0; font-weight: bold;"
                                        class="btn btn-primary pull-right" value='支付财务费用' onclick='REClick0(value)'> 显示全部
                                    </button>
                                    <button type="button" style="width: 100px; border-radius: 100px; font-size: 10px;
                                        border: 0px solid #c0c0c0; font-weight: bold;" class="btn btn-primary pull-right"
                                        value='财务费用' onclick='RE1Click(value)'>
                                        计入财务费用
                                    </button>
                                </div>
                                
                        </div>
                        <div class="row">
                            <div class="col-md-12" style="margin-bottom: 0px">
                                <div id="IncomeGroup" style="display: none">
                                    <input type="radio" name="Type" id="radio1" value="经营活动付款" checked="checked" />
                                    <label for="radio1">
                                        经营活动付款
                                    </label>
                                    </br>
                                    <input type="radio" name="Type" id="radio2" value="投资活动付款" />
                                    <label for="radio2">
                                        投资活动付款
                                    </label>
                                    </br>
                                    <input type="radio" name="Type" id="radio3" value="筹资活动付款" />
                                    <label for="radio3">
                                        筹资活动付款
                                    </label>
                                    </br> <a class="btn btn-default" onclick="Next()">下一页</a>
                                </div>
                                <div id="r1" style="display: none">
                                    <input type="radio" name="TypeDts" id="radio11" value="购买商品、接受服务所支付的款" />
                                    <label for="radio11">
                                        购买商品、接受服务所支付的款
                                    </label>
                                    </br>
                                   
                                    <input type="radio" name="TypeDts" id="radio15" value="支付管理费用" />
                                    <label for="radio15">
                                       支付管理费用
                                    </label>
                                    </br>
                                    
                                    <input type="radio" name="TypeDts" id="radio15" value="支付财务费用" />
                                    <label for="radio15">
                                        支付财务费用
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio15" value="支付销售费用" />
                                    <label for="radio15">
                                        支付销售费用
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio12" value="支付其他业务成本" />
                                    <label for="radio12">
                                        支付其他业务成本
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio13" value="支付其他与经营活动有关的款" />
                                 <label for="radio13">
                                        支付其他与经营活动有关的款
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio13" value="支付营业外支出" />
                                    <label for="radio13">
                                        支付营业外支出
                                    </label>
                                    </br>
                                    
                                    <input type="radio" name="TypeDts" id="radio14" value="支付暂支借款" />
                                    <label for="radio14">
                                        支付暂支借款
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio13" value="支付押金" />
                                    <label for="radio13">
                                        支付押金
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio13" value="归还其它公司支付的押金" />
                                    <label for="radio13">
                                        归还其它公司支付的押金
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio13" value="支付职工薪酬" />
                                    <label for="radio13">
                                        支付职工薪酬
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio13" value="支付的各项税费" />
                                    <label for="radio13">
                                        支付的各项税费
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio13" value="预付供应商账款" />
                                    <label for="radio13">
                                        预付供应商账款
                                    </label>
                                    </br> <a class="btn btn-default" onclick="ShowRecord()">提交</a> <a class="btn btn-default"
                                        onclick="Back()">返回</a>
                                </div>
                                <div id="r2" style="display: none">
                                   
                                    <input type="radio" name="TypeDts" id="radio21" value="购买固定资产所支付的款" />
                                    <label for="radio21">
                                      购买固定资产所支付的款
                                    </label>
                                    </br>
                                   
                                    <input type="radio" name="TypeDts" id="radio22" value="购买无形资产所支付的款" />
                                    <label for="radio22">
                                       购买无形资产所支付的款
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio22" value="购买其他长期资产所支付的款" />
                                    <label for="radio22">
                                        购买其他长期资产所支付的款
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio22" value="短期投资支出" />
                                    <label for="radio22">
                                        短期投资支出
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio22" value="长期股权投资支出" />
                                    <label for="radio22">
                                        长期股权投资支出
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio22" value="长期债券投资支出" />
                                    <label for="radio22">
                                        长期债券投资支出
                                    </label>
                                    </br> <a class="btn btn-default" onclick="ShowRecord()">提交</a> <a class="btn btn-default"
                                        onclick="Back()">返回</a>
                                </div>
                                <div id="r3" style="display: none">
                                   
                                    <input type="radio" name="TypeDts" id="radio31" value="分配利润、股利所支付的款" />
                                    <label for="radio31">
                                     分配利润、股利所支付的款
                                    </label>
                                    </br>
                                    
                                    <input type="radio" name="TypeDts" id="radio32" value="归还短期借款所支付的款" />
                                    <label for="radio32">
                                        归还短期借款所支付的款
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio33" value="归还长期借款所支付的款" />
                                    <label for="radio33">
                                        归还长期借款所支付的款
                                    </label>
                                    </br>
                                    <input type="radio" name="TypeDts" id="radio33" value="偿付利息所支付的款" />
                                    <label for="radio33">
                                        偿付利息所支付的款
                                    </label>
                                    </br> </label></br> <a class="btn btn-default" onclick="ShowRecord()">提交</a> <a class="btn btn-default"
                                        onclick="Back()">返回</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="button4" disabled="true" class="btn btn-default" data-dismiss="modal"
                            onclick="RSubmit()">
                            归账
                        </button>
                        <button type="button" class="btn btn-default" data-dismiss="modal" onclick="close()">
                            关闭
                        </button>
                    </div>
                </div>
                <!-- /.modal-content -->
            </div>
            <!-- /.modal -->
        </div>
        </div>
        <div class="modal fade" id="Editdialog" tabindex="-1" role="dialog" aria-labelledby="amyModalLabel"
            aria-hidden="true">
            <div class="modal-dialog" style="width: 800px">
                <div class="modal-content">
                    <input type="hidden" value="" id="actionHandler" name="actionHandler" />
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            &times;
                        </button>
                        <h4 class="modal-title" id="amyModalLabel">
                            编辑付款
                        </h4>
                    </div>
                    <div id="Example_Edit">
                        <div class="modal-body">
                            <div class="row">
                                <input type="hidden" value="" id="GUID" name="GUID" />
                                <div class="col-md-12" style="margin-top: 10px;" onclick="removeClass()">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <div class="input-group input-group-sm" style="margin: 0">
                                                <span class="input-group-addon">收款账户</span>
                                                <select id="PRBankAccount" name="PRBankAccount">
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <div class="input-group input-group-sm" style="margin: 0">
                                                <span class="input-group-addon">&nbsp;&nbsp;&nbsp;&nbsp;货币&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                <select id="PRCurrency" name="PRCurrency">
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <div class="input-group input-group-sm" style="margin: 0">
                                                <span class="input-group-addon">收款单位</span>
                                                <input id="autocomplete2" name="Log" class="form-control">
                                                <input id="Log2" name="RPer" hidden>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <div class="input-group input-group-sm" style="margin: 0">
                                                <span class="input-group-addon">付款金额</span>
                                                <input type="number" class="Amount form-control money" maxlength="10" min="0.1" autocomplete="off"
                                                    placeholder="" id="amt">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <div class="input-group input-group-sm" style="margin: 0">
                                                <span class="input-group-addon">付款日期</span>
                                                <input type="text" class="Date form-control datepicker mtn " id="payDate" name="payDate">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <div class="input-group input-group-sm" style="margin: 0">
                                                <span class="input-group-addon">&nbsp;&nbsp;&nbsp;&nbsp;备注&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                <input type="text" class="Remark form-control" placeholder="" required="true" id="Remark"
                                                    name="Remark">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group" style="margin-left: 10px">
                                        <div class="input-group input-group-sm" style="margin: 0">
                                            <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;附&nbsp;&nbsp;&nbsp;&nbsp;件&nbsp;&nbsp;</span>
                                            <button class="btn btn-primary btn-sm" style="width: 140px; margin-left: 2px; margin-right: 10px"
                                                type="button" onclick="ShowFirstUpLoadDialog('Editdialog')">
                                                上传附件</button>
                                            <button class="btn btn-primary btn-sm" style="width: 140px; margin-right: 0px;" id=""
                                                name="" type="button" onclick="showUploadFile('Editdialog')">
                                                &nbsp;&nbsp;&nbsp;浏&nbsp;&nbsp;&nbsp;览....</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal" onclick="editRe()">
                            提交
                        </button>
                        <button type="button" class="btn btn-default" data-dismiss="modal">
                            关闭
                        </button>
                    </div>
                </div>
                <!-- /.modal-content -->
                <!-- /.modal -->
            </div>
        </div>
        <div class="modal fade" id="AddIncome" tabindex="-1" role="dialog" aria-labelledby="amyModalLabel"
            aria-hidden="true">
            <div class="modal-dialog" style="width: 800px">
                <div class="modal-content">
                    <input type="hidden" value="" id="actionHandler" name="actionHandler" />
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            &times;
                        </button>
                        <h4 class="modal-title" id="amyModalLabel">
                            计入费用
                        </h4>
                    </div>
                    <div class="modal-body" style="margin-bottom: 0px">
                        <div class="row">
                            <div id="IncomeCategory">
                                <div id="a1" style="display: none">
                                    <input type="radio" name="TypeL" id="radio1" value="记录营业成本" checked="checked" />
                                    <label for="radio1">
                                        记录营业成本
                                    </label>
                                    </br>
                                </div>
                                <div id="a2" style="display: none">
                                    <input type="radio" name="TypeL" id="radio2" value="记录销售费用" />
                                    <label for="radio2">
                                        记录销售费用
                                    </label>
                                    </br>
                                </div>
                                <div id="a3" style="display: none">
                                    <input type="radio" name="TypeL" id="radio3" value="记录管理费用" />
                                    <label for="radio3">
                                        记录管理费用
                                    </label>
                                    </br>
                                </div>
                                <div id="a4" style="display: none">
                                    <input type="radio" name="TypeL" id="radio4" value="记录财务费用" />
                                    <label for="radio4">
                                        记录财务费用
                                    </label>
                                    </br>
                                </div>
                                <div id="a5" style="display: none">
                                    <input type="radio" name="TypeL" id="radio5" value="记录工资成本" />
                                    <label for="radio5">
                                        记录工资成本
                                    </label>
                                    </br>
                                </div>
                                <div id="a6" style="display: none">
                                    <input type="radio" name="TypeL" id="radio6" value="税费" />
                                    <label for="radio6">
                                        税费
                                    </label>
                                    </br>
                                </div>
                                <a class="btn btn-default" onclick="NextIncome()">下一页</a>
                            </div>
                            <div id="IncomeAdd" style="display: none">
                                <div id="Example_IncomeAdd">
                                    
                                                        <div class="col-md-12" style="margin-bottom: 0px" onclick="removeClass()">
                                                            <form class="cmxform" id="Expense_Form" method="get">
                                                            <input type="reset" name="reset" style="display: none;" />
                                                            <input type="hidden" name="State" id="State" value="已付" />
                                                            <input type="hidden" name="IE_GUID" id="IE_GUID1" value="" />
                                                            <input type="hidden" name="GUID" id="GUID" value="" />
                                                            <input type="hidden" name="Profit_Name" id="Profit_Name" />
                                                            <input type="hidden" name="InvType" id="InvType" value="" />
                                                            <input type="hidden" name="IE_Flag" id="IE_Flag" value="" />
                                                            <input type="hidden" name="SumAmount" id="SumAmount1" />
                                                            <input type="hidden" name="RPType" id="RPType" />
                                                            <input type="hidden" name="DetailRPType" id="DetailRPType" />
                                                            <div class="col-md-12" style="text-align: center">
                                                                <div class="col-md-6" style="padding-right: 25px">
                                                                    <div class="form-group">
                                                                        <div class="input-group input-group-sm" style="margin: 0">
                                                                            <span class="input-group-addon" style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;供应商&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                            <input id="autocomplete1" name="Log" class="form-control">
                                                                            <input id="Log1" name="RPer" hidden>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-12" style="text-align: center">
                                                                <div class="col-md-6" style="padding-right: 25px">
                                                                    <div class="form-group">
                                                                        <div class="input-group input-group-sm" style="margin: 0">
                                                                            <span class="input-group-addon" style="color: #000000;">&nbsp;&nbsp;&nbsp;费用确认日期&nbsp;&nbsp;&nbsp;</span>
                                                                            <input type="text" id="AffirmDate" name="AffirmDate" class="form-control datepicker mtn"
                                                                                required="true">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-6" style="padding-left: 25px">
                                                                    <div class="form-group">
                                                                        <div class="input-group input-group-sm" style="margin: 0">
                                                                            <span class="input-group-addon" style="color: #000000;">&nbsp;&nbsp;&nbsp;账期截止日期&nbsp;&nbsp;&nbsp;</span>
                                                                            <input type="text" id="Date" name="Date" class="form-control datepicker mtn" required="true">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                           
                                                            
                                                                <div class="col-md-12" style="text-align: center">
                                                                    <div class="col-md-6" style="padding-right: 25px">
                                                                        <div class="form-group">
                                                                            <div class="input-group input-group-sm" style="margin: 0">
                                                                                <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;费用详细类别&nbsp;&nbsp;&nbsp;</span>
                                                                                <select id="IEGroup" name="IEGroup">
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-6" style="padding-left: 25px">
                                                                        <div class="form-group">
                                                                            <div class="input-group input-group-sm" style="margin: 0">
                                                                                <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;费用描述&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                                <input id="IEDescription" name="IEDescription" type="text" class="form-control" placeholder=""
                                                                                    required="true">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-12" style="text-align: center">
                                                                    <div class="col-md-6" style="padding-right: 25px">
                                                                        <div class="form-group">
                                                                            <div class="input-group input-group-sm" style="margin: 0">
                                                                                <span class="input-group-addon" style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;费&nbsp;用&nbsp;金&nbsp;额&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                                <input type="text" id="Amount" name="Amount" class="form-control money" maxlength="10"
                                                                                    autocomplete="off" min="0.1" placeholder="">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-6" style="padding-left: 25px">
                                                                        <div class="form-group">
                                                                            <div class="input-group input-group-sm" style="margin: 0">
                                                                                <span class="input-group-addon" style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;货&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;币&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                                <select id="Currency" name="Currency" required="true">
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-12" style="text-align: center">
                                                                    <div class="col-md-6" style="padding-right: 25px">
                                                                        <div class="form-group">
                                                                            <div class="input-group input-group-sm" style="margin: 0">
                                                                                <span class="input-group-addon" style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;税&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;种&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                                <select id="TaxationType" name="TaxationType" required="true">
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-6" style="padding-left: 25px">
                                                                        <div class="form-group">
                                                                            <div class="input-group input-group-sm" style="margin: 0">
                                                                                <span class="input-group-addon" style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;税&nbsp;费&nbsp;金&nbsp;额&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                                <input id="TaxationAmount" name="TaxationAmount" type="text" class="form-control"
                                                                                    required="true">
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                               
                                                                                    <div class="col-md-12" style="text-align: center">
                                                                                        <div class="col-md-6" style="padding-right: 25px">
                                                                                            <fieldset disabled>
                                                                                                <div class="form-group">
                                                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                                                        <span class="input-group-addon" style="color: #000000;">&nbsp;&nbsp;&nbsp;含&nbsp;税&nbsp;总&nbsp;费&nbsp;用&nbsp;&nbsp;&nbsp;</span>
                                                                                                        <input id="SumAmount" name="SumAmount" type="text" class="form-control" placeholder=""
                                                                                                            required="true">
                                                                                                    </div>
                                                                                                </div>
                                                                                            </fieldset>
                                                                                        </div>
                                                                                        <div class="col-md-6" style="padding-left: 25px">
                                                                                            <div class="form-group">
                                                                                                <div class="input-group input-group-sm" style="margin: 0">
                                                                                                    <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;备&nbsp;&nbsp;&nbsp;注&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                                                    <input id="Remark" name="Remark" type="text" class="form-control" placeholder=""
                                                                                                        required="true">
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="col-md-12" style="text-align: center;">
                                                                                        <div class="col-md-6" style="padding-right: 25px">
                                                                                            <div class="form-group">
                                                                                                <div class="input-group input-group-sm" style="margin: 0">
                                                                                                    <span class="input-group-addon" style="color: #000000;">合同/发票/凭证号</span>
                                                                                                    <input type="text" id="InvNo" name="InvNo" class="Pnumber form-control" placeholder="">
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="col-md-6" style="padding-left: 25px">
                                                                                            <div class="form-group">
                                                                                                <div class="input-group input-group-sm" style="margin: 0">
                                                                                                    <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;附&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;件&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                                                    <button class="btn btn-primary btn-sm" style="width: 100px; margin-left: 2px; margin-right: 10px"
                                                                                                        type="button" onclick="ShowFirstUpLoadDialog('IncomeAdd')">
                                                                                                        上传附件</button>
                                                                                                    <button class="btn btn-primary btn-sm" style="width: 100px; margin-right: 0px;" id=""
                                                                                                        name="" type="button" onclick="showUploadFile('IncomeAdd')">
                                                                                                        &nbsp;&nbsp;&nbsp;浏&nbsp;&nbsp;&nbsp;览....</button>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div id="WCRecordAdd" style="display: none">
                                                    <div class="col-md-12" style="margin-bottom: 0px" onclick="removeClass()">
                                                        <form id="payForm" action="#">
                                                        <input type="reset" name="reset" style="display: none;" />
                                                        <input type="hidden" name="IE_GUID" value="" id="IE_GUID" />
                                                        <input type="hidden" name="Profit_GUID" id="Profit_GUID" />
                                                        <input type="hidden" name="W_GUID" value="" id="W_GUID" />
                                                        <input type="hidden" name="State" value="已付" id="State" />
                                                        <div class="col-md-12" style="text-align: center">
                                                            <div class="col-md-6" style="padding-right: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;姓名&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                        <input type="text" class="form-control" id="Employee" name="Employee" value="">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6" style="padding-left: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;认定日期&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                        <input type="text" id="AffirmDate" name="AffirmDate" class="form-control datepicker mtn">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12" style="text-align: center">
                                                            <div class="col-md-6" style="padding-right: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;类别&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                        <select id="InvType" name="InvType">
                                                                            <option value="营业成本">营业成本</option>
                                                                            <option value="销售费用">销售费用</option>
                                                                            <option value="管理费用">管理费用</option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6" style="padding-left: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;货币&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                        <select id="PRCurrency" name="PRCurrency">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12" style="text-align: center">
                                                            <div class="col-md-6" style="padding-right: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;应付现金&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                        <input type="text" id="Total" name="Total" class="form-control" value="">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div id="TaxRecordAdd" style="display: none">
                                                    <div class="col-md-12" style="margin-bottom: 0px" onclick="removeClass()">
                                                        <form class="cmxform" id="Expense_Form1" method="get">
                                                        <input type="reset" name="reset" style="display: none;" />
                                                        <input type="hidden" name="IE_GUID" id="IE_GUID" />
                                                        <input type="hidden" name="State" id="State" value="已付" />
                                                        <input type="hidden" name="InvType" id="InvType" />
                                                        <input type="hidden" name="SumAmount" id="SumAmount1" />
                                                        <input type="hidden" name="Profit_GUID" id="Profit_GUID" />
                                                        <div class="col-md-12" style="text-align: center">
                                                            <div class="col-md-6" style="padding-right: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;税费类别&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                        <select id="IEGroup" name="IEGroup">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6" style="padding-left: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;费用描述&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                        <input type="text" id="IEDescription" name="IEDescription" class="form-control">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12" style="text-align: center">
                                                            <div class="col-md-6" style="padding-right: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;税费计提日期&nbsp;&nbsp;&nbsp;</span>
                                                                        <input type="text" id="AffirmDate" name="AffirmDate" class="form-control datepicker mtn">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6" style="padding-left: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">合同/发票/凭证号</span>
                                                                        <input type="text" id="InvNo" name="InvNo" class="Pnumber form-control" placeholder="">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12" style="text-align: center">
                                                            <div class="col-md-6" style="padding-right: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;税费金额&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                        <input id="SumAmount" name="SumAmount" type="text" class="form-control money" placeholder=""
                                                                            required="true">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6" style="padding-left: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;货币&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                        <select id="Currency" name="Currency">
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-12" style="text-align: center">
                                                            <div class="col-md-6" style="padding-right: 25px">
                                                                <div class="form-group">
                                                                    <div class="input-group input-group-sm" style="margin: 0">
                                                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;备注&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                                                        <input type="text" id="Remark" name="Remark" class="form-control" placeholder="">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" id="button1" disabled="true" class="btn btn-default" data-dismiss="modal"
                                                onclick="ISubmit()">
                                                提交
                                            </button>
                                            <button type="button" class="btn btn-default" onclick="close()" data-dismiss="modal">
                                                关闭
                                            </button>
                                        </div>
                                    </div>
                                    <!-- /.modal-content -->
                                </div>
                                <!-- /.modal -->
                            </div>
                            <div class="modal fade" id="AddDcSpending" tabindex="-1" role="dialog" aria-labelledby="amyModalLabel"
                                aria-hidden="true">
                                <div class="modal-dialog" style="width: 800px">
                                    <div class="modal-content">
                                        <input type="hidden" value="" id="actionHandler" name="actionHandler" />
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" onclick="close()" aria-hidden="true">
                                                &times;
                                            </button>
                                            <h4 class="modal-title" id="amyModalLabel">
                                                计入成本外支出
                                            </h4>
                                        </div>
                                        <div id="Example_AddDcSpending">
                                            <div class="modal-body" style="margin-bottom: 0px">
                                                <div class="row" onclick="removeClass()">
                                                    <form class="cmxform" id="altForm" method="post">
                                                    <input type="hidden" name="State" id="State" value="已付" />
                                                    <input type="hidden" name="Record" id="Record" value="未记录" />
                                                    <input type="hidden" name="GUID" id="GUID" />
                                                    <div class="col-md-4">
                                                        <div class="form-group">
                                                            <div class="input-group" style="margin: 0">
                                                                <span class="input-group-addon">支出类别</span>
                                                                <select id="InvType" name="InvType">
                                                                    <option value="预付供应商" selected="selected">预付供应商</option>
                                                                    <option value="支付押金和暂支借款">支付押金和暂支借款</option>
                                                                    <option value="投资支出">投资支出</option>
                                                                    <option value="直接物料采购">直接物料采购</option>
                                                                    <option value="间接物料采购">间接物料采购</option>
                                                                    <option value="资产采购">资产采购</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="input-group" style="margin: 0">
                                                                <span class="input-group-addon">申报日期</span>
                                                                <input type="text" id="datepicker" name="Date" class="form-control datepicker mtn">
                                                                <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="input-group" style="margin: 0">
                                                                <span class="input-group-addon">申报金额</span>
                                                                <input type="text" id="maskedMoney" name="Amount" class="form-control money" maxlength="10"
                                                                    autocomplete="off" placeholder=""><span class="input-group-addon"><i class="fa fa-usd"></i></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="form-group">
                                                            <div class="input-group input-group-sm" style="margin: 0; width: 100%">
                                                                <span class="input-group-addon">收款单位</span>
                                                                <select id="Payee" name="RPer">
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="input-group" style="margin: 0">
                                                                <span class="input-group-addon"><i class="glyphicon glyphicon-leaf"></i>凭证号</span>
                                                                <input id="wage" name="VoucherNo" type="text" class="form-control" placeholder="">
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <div class="input-group input-group-sm" style="margin: 0">
                                                                <span class="input-group-addon">&nbsp;&nbsp;&nbsp;货&nbsp;币&nbsp;&nbsp;&nbsp;</span>
                                                                <select id="Currency" name="Currency" required="true">
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="form-group">
                                                            <textarea class="form-control" id="textArea" name="Remark" rows="5" placeholder="备注..."></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <div class="form-group">
                                                            <div class="input-group input-group-sm" style="margin: 0; width: 100%">
                                                                <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;附&nbsp;&nbsp;&nbsp;&nbsp;件&nbsp;&nbsp;</span>
                                                                <button class="btn btn-primary btn-sm" style="width: 140px; margin-left: 2px; margin-right: 10px"
                                                                    type="button" onclick="ShowFirstUpLoadDialog('AddDcSpending')">
                                                                    上传附件</button>
                                                                <button class="btn btn-primary btn-sm" style="width: 140px; margin-right: 0px;" id=""
                                                                    name="" type="button" onclick="showUploadFile('AddDcSpending')">
                                                                    &nbsp;&nbsp;&nbsp;浏&nbsp;&nbsp;&nbsp;览....</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" id="button2" disabled="true" class="btn btn-default" data-dismiss="modal"
                                                onclick="ISubmit1()">
                                                提交
                                            </button>
                                            <button type="button" class="btn btn-default" onclick="close()" data-dismiss="modal">
                                                关闭
                                            </button>
                                        </div>
                                    </div>
                                    <!-- /.modal-content -->
                                </div>
                                <!-- /.modal -->
                            </div>
                            <div class="modal fade" id="AmountUsed" tabindex="-1" role="dialog" aria-labelledby="AmountUsed"
                                aria-hidden="true">
                                <div class="modal-dialog" style="width: 800px">
                                    <div class="modal-content">
                                        <input type="hidden" value="" id="actionHandler" name="actionHandler" />
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                                &times;
                                            </button>
                                            <h4 class="modal-title" id="amyModalLabel">
                                                已销账
                                            </h4>
                                        </div>
                                        <div class="modal-body">
                                            <div class="row">
                                                <div class="col-md-12" style="margin-bottom: 0px">
                                                    <table id="dataListAmountUsed" style="font-size: 12px">
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">
                                                关闭
                                            </button>
                                        </div>
                                    </div>
                                    <!-- /.modal-content -->
                                </div>
                                <!-- /.modal -->
                            </div>
                            <div class="modal fade" id="Voucher" tabindex="-1" role="dialog" aria-labelledby="AmountUsed"
                                aria-hidden="true">
                                <div class="modal-dialog" style="width: 800px">
                                    <div class="modal-content">
                                        <input type="hidden" value="" id="actionHandler" name="actionHandler" />
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                                &times;
                                            </button>
                                            <h4 class="modal-title" id="amyModalLabel">
                                                凭证
                                            </h4>
                                        </div>
                                        <div class="modal-body">
                                            <div class="row" style="margin-bottom: 20px">
                                                <div class="col-md-12" style="margin-bottom: 5px; text-align: center">
                                                    <span style="font-size: 30px; font-weight: 900; color: #000000; text-decoration: underline">
                                                        记账凭证</span>
                                                </div>
                                                <div class="col-md-12" style="margin-bottom: 5px;">
                                                    <div class="col-md-4">
                                                    </div>
                                                    <div class="col-md-4" style="text-align: center">
                                                        <span id="VoucherDate"></span>
                                                    </div>
                                                    <div class="col-md-4" style="text-align: center;">
                                                        <span>本币：@Session["Currency"] 单位：元</span>
                                                    </div>
                                                </div>
                                                <div class="col-md-12" style="margin-bottom: 5px;">
                                                    <span>核算单位：</span>
                                                    @Session["FullName"]
                                                    <span id="num" style="float: right"></span>
                                                </div>
                                                <div class="col-md-12" style="margin-bottom: 10px">
                                                    <table id="VoucherTable" class="table table-striped table-bordered table-condensed"
                                                        style="font-size: 12px">
                                                    </table>
                                                </div>
                                                <div class="col-md-12" style="margin-left: -10px">
                                                    <div class="col-md-2">
                                                        <span>财务主管:</span>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <span>记账:</span>
                                                        @Session["NickName"]
                                                    </div>
                                                    <div class="col-md-2">
                                                        <span>复核:</span>
                                                        @Session["NickName"]
                                                    </div>
                                                    <div class="col-md-2">
                                                        <span>出纳:</span>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <span>制单:</span>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <span>经办人:</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">
                                                关闭
                                            </button>
                                        </div>
                                    </div>
                                    <!-- /.modal-content -->
                                </div>
                                <!-- /.modal -->
                            </div>
                            <!--上传附件model-->
                            <div class="modal fade" id="AttachmentImportModal" tabindex="-1" role="dialog" aria-labelledby="AttachmentImportModal"
                                aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="CloseAttachmentImportModal()">
                                                <span aria-hidden="true">&times;</span></button>
                                            <h4 class="modal-title" id="excelImportModal">
                                                附件上传</h4>
                                        </div>
                                        <div>
                                            <div class="modal-body" style="width: 50%; float: left;">
                                                <input type="hidden" id="uploadformid" />
                                                <div id="uploader" class="wu-example">
                                                    <!--用来存放文件信息-->
                                                    <div class="btns">
                                                        <table>
                                                            <tr>
                                                                <td>
                                                                    <div id="picker">
                                                                        选择文件</div>
                                                                </td>
                                                                <td>
                                                                    <div id="thelist" class="uploader-list">
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </div>
                                                <input type="hidden" id="flag" />
                                            </div>
                                            <div class="modal-body" style="width: 50%; float: left; padding: 5px; padding-left: 85px">
                                                <div id="qrcode" class="modal-body" style="width: 100%; padding: 10px; text-align: center;">
                                                    <img src="/img/qrcode.jpg" />
                                                </div>
                                                <div style="width: 60%; text-align: center; margin-left: 42px">
                                                    <span style="font-size: 14px">扫描二维码通过手机上传附件</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal" onclick="CloseAttachmentImportModal()">
                                                Close</button>
                                            <button id="ASubmitBtn" class="btn btn-primary" type="button" onclick="ASubmitBtn()">
                                                提交</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--显示当前id附件记录model-->
                            <div class="modal fade" id="showhaveuploadedModal" tabindex="-1" role="dialog" aria-labelledby="countryModalLabel"
                                aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span></button>
                                            <h4 class="modal-title">
                                                附件查看</h4>
                                        </div>
                                        <div class="modal-body">
                                            <table id="showhaveuploaded">
                                            </table>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">
                                                Close</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--编辑当前记录名称model-->
                            <div class="modal fade" id="edithaveuploadedModal" tabindex="-1" role="dialog" aria-labelledby="edithaveuploadedModal"
                                aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <input type="hidden" value="" id="actionHandler" name="actionHandler" />
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                                &times;
                                            </button>
                                            <h4 class="modal-title" id="myModalLabel">
                                                编辑附件名称
                                            </h4>
                                        </div>
                                        <div class="modal-body">
                                            <div class="row">
                                                <form class="cmxform" id="D_Form" method="post">
                                                <input type="hidden" name="A_GUID" id="GUID" />
                                                <input type="hidden" name="FR_GUIDS" id="FR_GUID" />
                                                <div class="col-md-12" style="text-align: center">
                                                    <div class="col-md-1">
                                                    </div>
                                                    <div class="col-md-5" style="padding-right: 25px">
                                                        <div class="form-group">
                                                            <div class="input-group input-group-sm" style="margin: 0">
                                                                <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;附&nbsp;件&nbsp;名&nbsp;称&nbsp;&nbsp;&nbsp;</span>
                                                                <input type="text" id="TempFileName" name="FileName" class=" form-control " maxlength="10"
                                                                    require="true" style="width: 350px" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                </form>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">
                                                关闭
                                            </button>
                                            <button type="button" class="btn btn-primary" onclick="EditUpload()">
                                                提交
                                            </button>
                                        </div>
                                    </div>
                                    <!-- /.modal-content -->
                                </div>
                                <!-- /.modal -->
                            </div>
                            <!--提交之后上传之前的名称提交model-->
                            <div class="modal fade" id="editunifiednameModal" tabindex="-1" role="dialog" aria-labelledby="editunifiednameModal"
                                aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                                                &times;
                                            </button>
                                            <h4 class="modal-title" id="myModalLabel">
                                                文件名称
                                            </h4>
                                        </div>
                                        <div class="modal-body">
                                            <div class="row">
                                                <form class="nameform" id="name_Form" method="post">
                                                <div class="col-md-12" style="text-align: center">
                                                    <div class="col-md-1">
                                                    </div>
                                                    <div class="col-md-5" style="padding-right: 25px">
                                                        <div class="form-group">
                                                            <div class="input-group input-group-sm" style="margin: 0">
                                                                <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;&nbsp;附&nbsp;件&nbsp;名&nbsp;称&nbsp;&nbsp;&nbsp;</span>
                                                                <input type="text" id="TempFileNameFirst" name="TempFileNameFirst" class=" form-control "
                                                                    maxlength="10" required style="width: 350px" />
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                </form>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">
                                                关闭
                                            </button>
                                            <button id="ctlBtn" class="btn btn-primary" type="button">
                                                上传
                                            </button>
                                        </div>
                                    </div>
                                    <!-- /.modal-content -->
                                </div>
                            </div>
                            <script language="javascript" type="text/javascript">
    jQuery(document).ready(function () {
        $("#Voucher").on("hidden.bs.modal", function () {
            $('#VoucherTable').bootstrapTable('destroy');
        });
        $("#amyModal").on("hidden.bs.modal", function () {
            $(this).removeData("bs.modal");
            document.getElementById("r1").style.display = "none";
            document.getElementById("r2").style.display = "none";
            document.getElementById("r3").style.display = "none";
        });
        $("#AddIncome").on("hidden.bs.modal", function () {
            $("input[type=reset]").trigger("click");
            $(this).removeData("bs.modal");
            document.getElementById("IncomeAdd").style.display = "none";
            document.getElementById("WCRecordAdd").style.display = "none";
            document.getElementById("TaxRecordAdd").style.display = "none";

        });
         $("#Editdialog").on("hidden.bs.modal", function () {
            $("input[type=reset]").trigger("click");
            $(this).removeData("bs.modal");
            
        });
        $("#AddDcSpending").on("hidden.bs.modal", function () {
            $(this).removeData("bs.modal");
        });
        $('#PayList').bootstrapTable({
            url: "/PaymentClassify/GetPaymentList",
            method: 'get',
            pageSize: 10,
            pageList: [5, 10, 25, 50, 100, 200], // 自定义分页列表
            pageNumber: 1,
            singleSelect: true,
            clickToSelect: true,
            checkOnSelect: true,
            selectOnCheck: true,
            pagination: true,
            sortName: 'CreateDate', // 设置默认排序为 name
            sortOrder: 'desc', // 设置排序为反序 desc
            search: false, // 开启搜索功能
            showColumns: false,
            showRefresh: false,
            showQuery: false,
            showToggle: false,
            showExport: false,
            exportTypes: ['xml', 'txt', 'excel'],
            columns: [
	            { class: "bs-checkbox", formatter: stateFormatter },
	            { field: 'Date', title: '@FMS.Resource.Finance.Finance.Date', width: '7%', align: 'center' },
	            { field: 'RPerName', title: '收款单位',width:'10%',align: 'center' },
	            { field: 'RP_GUID', title: '@FMS.Resource.Finance.Finance.Amount', align: 'center', formatter: LinkHandleAmount },
	            { field: 'Currency', title: '@FMS.Resource.Finance.Finance.Currency', align: 'center' },
	            { field: 'InvType', width: '10%', title: "@FMS.Resource.Finance.Finance.Payment@FMS.Resource.Finance.Finance.Group", align: 'center' },
                { field: 'InvTypeDts', width: '10%', align: 'center', title: "付款子类" },
//	            { field: 'AccountAbbreviation', title: '付款账户',width:'13%',align: 'center' },
	           //{ field: 'Remark', width: '7%', title: '@General.Resource.Common.Remark' },
                { field: 'DetailInvType', width: '10%', align: 'center', title: "付款详细类别" },
	            { field: 'PayCategory', title: '资金类别',align: 'center', width: '10%' },
                { field: 'DetailRPType', title: '资金子类',align: 'center' , width: '10%'},
	           //{ field: 'Remark', width: '7%', title: '@General.Resource.Common.Remark' },
                { field: 'Record', width: '8%', title: "销账状态", align: 'center' },
	             //{ field: 'A_GUID', title: '附件', width:'7%',align: 'center', formatter: FJHandle },
	            { field: 'RP_GUID', title: '', formatter: LinkHandle, width: '12%' }
	            ],
            queryParams: queryParams

        });
    });
   
    var LinkHandleAmount = function (value, row, index) {
        if (row.SumAmount < 0) {
            var link1 = "<a class='' >  \ " + '0 ' + "\</a>"
        }
        else if (row.SumAmount >= 0) {
            var link1 = "<a class='linkbtn' onclick='AmountUsed(\"" + value + "\")'><font color=blue>\ " + DecimalFmter(row.SumAmount) + "\</font></a>"
        }
        return link1;
    };

    function removeClass() {
        $(".filter").hide();

    }

    function AmountUsed(id) {
        $('#dataListAmountUsed').bootstrapTable('destroy');
        $('#dataListAmountUsed').bootstrapTable({
            url: "/ExpenseQuery/GetIERecord?id=" + id, //请求后台的URL（*）
            method: 'get', //请求方式（*）
            pageSize: 10, //每页的记录行数（*）
            pageList: [10, 20, 50, 100, 200], // 自定义分页列表
            pageNumber: 1, //初始化加载第一页，默认第一页
            singleSelect: true,
            clickToSelect: true,
            checkOnSelect: true,
            selectOnCheck: true,
            cardView: false, //是否显示详细视图
            pagination: true, //是否显示分页（*）
            sortName: 'CreateDate', // 设置默认排序为 name
            sortOrder: 'desc', // 设置排序为反序 des
            search: false, // 开启搜索功能
            showColumns: false,
            showRefresh: false,
            showQuery: false,
            showToggle: false, //是否显示详细视图和列表视图的切换按钮
            showExport: false,
            exportTypes: ['xml', 'txt', 'excel'],
            columns: [
                { field: 'CreateDate', title: '@FMS.Resource.Finance.Finance.Date', width: '7%' },
	            { field: 'RPerName', title: '收款单位', width: '10%', align: 'center' },
	            { field: 'SumAmount', title: '@FMS.Resource.Finance.Finance.Amount', width: '10%', align: 'center', formatter: DecimalFmter },
	            { field: 'Amount_Used', title: '销账金额', width: '10%', align: 'center' },
                { field: 'InvType', title: "@FMS.Resource.Finance.Finance.Payment@FMS.Resource.Finance.Finance.Group", width: '12%' },
                { field: 'State', width: '10%', title: "付款状态" }
            ]


        });

        $('#AmountUsed').modal({ show: true, backdrop: 'static' });
        $(".boxed-layout").css("padding-right", "0px");

    }

   function REClick0(value){
    $('#aTable').bootstrapTable('destroy'); 
       var TypeDts = value;
   if(TypeDts == "购买商品、接受服务所支付的款"){
//    url ='/PaymentRecord/GetUnionList'
     url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('营业成本');
    }else if(TypeDts == "支付管理费用"){
           url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('管理费用');
        }else if(TypeDts == "支付财务费用"){
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('财务费用');
        }else if(TypeDts == "支付销售费用"){
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('销售费用');
        }
        else if(TypeDts == "支付其他业务成本"){
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('其他业务成本');
        }else if(TypeDts == "支付营业外支出"){
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('营业外支出');
        }else if (TypeDts == "支付押金") {
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('支付押金');
        }else if (TypeDts == "支付暂支借款") {
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('支付暂支借款');
        } else if (TypeDts == "归还其它公司支付的押金") {
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('归还其它公司支付的押金');
        }  else if (TypeDts == "预付供应商账款") {
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('预付供应商账款');
        } else if (TypeDts == "短期投资支出") {
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('短期投资支出'); 
        } else if (TypeDts == "长期股权投资支出") {
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('长期股权投资支出');
        } else if (TypeDts == "长期债券投资支出") {
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('长期债券投资支出');
        } else if (TypeDts == "购买固定资产所支付的款") {
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('购买固定资产所支付的款');
        } else if (TypeDts == "购买无形资产所支付的款") {
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('购买无形资产所支付的款');
        }else if (TypeDts == "购买其他长期资产所支付的款") {
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('购买其他长期资产所支付的款');
        }else if (TypeDts == "归还债务所支付的款") {
            url = '/ReceivablesDeclareCustomer/ChooseReceivablesDeclareCustomerList?record='+ escape('未还款')+"&flag="+"P"+ "&customer="+ name;
        } else if (TypeDts == "分配股利、利润的款") {
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('分配股利、利润');
        }else if (TypeDts == "偿付利息所支付的款") {
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('财务费用');
        }else if (TypeDts == "支付职工或为职工支付的款") {
           url = '/WageCostsRecord/GetWageCostList?state=' + escape('未付');
        } else if (TypeDts == "分配利润、股利所支付的款") {
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('分配利润、股利所支付的款');
        }else if (TypeDts == "偿付利息所支付的款") {
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('财务费用');
        }else if (TypeDts == "支付职工薪酬") {
           url = '/WageCostsRecord/GetWageCostList?state=' + escape('未付');
        } else if (TypeDts == "支付的各项税费") {
             url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('税费');
        }
      var columns = new Array();
            columns.push({ field: 'ck', checkbox: true, title: '选择', width: '50' });
            columns.push({ field: 'RPerName', title: '@FMS.Resource.Finance.Finance.Payee', align: 'center' });
            columns.push({ field: 'InvType', title: '付款类别', align: 'center' });
              columns.push({ field: 'Amount', title: '付款金额', align: 'center', formatter: DecimalFmter });
            if(arr1.indexOf(TypeDts)>-1){
                 columns.push({ field: 'IEGroup', title: '详细类别',align: 'center' });
                columns.push({ field: 'IE_GUID', title: '未销金额', formatter:LinkHandleResidualAmount,align: 'center' });
                 columns.push({ field: 'Remark', title: '备注', align: 'center' });
                columns.push({ field: 'InvNo', title: '@FMS.Resource.Finance.Finance.InvNo', align: 'center' });
            }if(arr2.indexOf(TypeDts)>-1){
          
                columns.push({ field: 'GUID', title: '未销金额', formatter: LinkHandleResidualAmount, align: 'center' });
                 columns.push({ field: 'Remark', title: '备注', align: 'center' });
                columns.push({ field: 'VoucherNo', title: '@FMS.Resource.Finance.Finance.InvNo', align: 'center' });
            }
//            if(TypeDts== "归还债务所支付的款"){
//                 columns.push({ field: 'GUID', title: '未销金额', formatter: LinkResidualAmount, align: 'center' });
//                  columns.push({ field: 'Remark', title: '备注', align: 'center' });
//                columns.push({ field: 'InvNo', title: '@FMS.Resource.Finance.Finance.InvNo', align: 'center' });
//            }
            $('#aTable').bootstrapTable('destroy'); 
            $('#aTable').bootstrapTable({
                url: url,
                method: 'get',
                pageSize: 5,
                pageList: [5, 10, 25, 50, 100, 200], // 自定义分页列表
                pageNumber: 1,
                clickToSelect: true,
                checkOnSelect: true,
                selectOnCheck: true,
                pagination: true,
                sortName: 'AffirmDate', // 设置默认排序为 name
                sortOrder: 'desc', // 设置排序为反序 desc
                search: false,
                showColumns: true,
                showRefresh: false,
                showQuery: false,
                showToggle: false,
                showExport: false,
                exportTypes: ['xml', 'txt', 'excel'],
                columns: columns,
	            onCheck: function (row) {
                 var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord.length!=0){
		          document.getElementById("button4").removeAttribute('disabled');
                  }else{
                  document.getElementById("button4").removeAttribute('disabled');
                  }
	            },
                onUncheck: function (row) {
                  var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord != 0){
                 document.getElementById("button4").removeAttribute('disabled');
		       
	            }else{
                 document.getElementById("button4").disabled  = "true";
                }
                },
                onCheckAll: function (row) {
                  var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord != 0){
                 document.getElementById("button4").removeAttribute('disabled');
		       
	            }else{
                 document.getElementById("button4").disabled  = "true";
                }
                },
                onUncheckAll: function (row) {
                  var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord != 0){
                 document.getElementById("button4").removeAttribute('disabled');
		       
	            }else{
                 document.getElementById("button4").disabled  = "true";
                }
                }
            });
   
   }
    function initFileInput(divName, ctrlName) {
        FileInputBaseSetting(divName + ctrlName);

        var control = $(divName + ctrlName);
        control.fileinput('refresh', {
            uploadUrl: '/ReceivablesRecord/NewUpload',
            allowedFileExtensions: ['jpg', 'png'],
            uploadExtraData: function () { // callback example
                var out = {};
                out['guid'] = $(divName + " #RP_GUID").val();
                //out['number'] = $(divName + ' .Pnumber').val();
                return out;
            }
        });

        control.on("fileuploaderror", function (event, data, msg) {
            // $('#excelImportModal').modal('hide');
            alert(msg);
        });
    }

    function query() {

        $('#PayList').bootstrapTable('refresh');
    }



    function queryParams(params) {  //配置参数
        var temp = {   //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
            pageSize: params.limit,   //页面大小
            pageIndex: params.pageNumber,  //页码
            dateBegin: $("#dateBegin").val(),
            dateEnd: $("#dateEnd").val(),
            customer: $("#customer").val(),
            incomeGrp: $("#incomeGrp").val(),
            InvTypeDts: $("#InvTypeDts").val(),
            record: $("#Record").val()
        };
        return temp;
    }
    function checkAmount() {
        var amount = $('#TaxRecordAdd #SumAmount').val() == '' ? 0 : $('#TaxRecordAdd #Amount').val();
        //        amount = amount.replace(/,/g, "");
        $('#TaxRecordAdd #SumAmount').val(Money(parseFloat(amount)));
    }


    function ChangeDateFormat(jsondate) {
        jsondate = jsondate.replace("/Date(", "").replace(")/", "");
        if (jsondate.indexOf("+") > 0) {
            jsondate = jsondate.substring(0, jsondate.indexOf("+"));
        }
        else if (jsondate.indexOf("-") > 0) {
            jsondate = jsondate.substring(0, jsondate.indexOf("-"));
        }

        var date = new Date(parseInt(jsondate, 10));
        var month = date.getMonth() + 1 < 10 ? "0" + (date.getMonth() + 1) : date.getMonth() + 1;
        var currentDate = date.getDate() < 10 ? "0" + date.getDate() : date.getDate();
        return date.getFullYear() + "-" + month + "-" + currentDate;
    }

    var stateFormatter = function (value, row, index) {
        if (row.Record == '已销账') {
            return "<input data-index=\"" + index + "\" name='btSelectItem' type='checkbox' disabled>";
        } else {
            return "<input data-index=\"" + index + "\" name='btSelectItem' type='checkbox'>";
        }

    };
    function DateHandle1(jsondate) {
        var reg=new RegExp("/","g");
        jsondate = jsondate.replace(reg,"-");
        return jsondate;
    }
    var LinkHandle = function (value, row) {
        var affDate = row.Date;
        var RepDate = affDate.substr(0, 7);


        var ieguid = row.IE_GUID;
        var link = "";
        var a = "<a class='linkbtn' onclick='EditClick(\"" + value + "\")'>@General.Resource.Common.Edit</a>";
        var b = "<a class='linkbtn' onclick='DeleteClick(\"" + value + '","' + RepDate + "\")'>@General.Resource.Common.Delete</a>";
        var c;
        //if (row.InvTypeDts != "支付的各项税费" && row.InvTypeDts != "支付职工薪酬") {
            c = " <a class='linkbtn'   onclick='GetVoucher(\"" + value +'","'+row.Date+ "\")'>凭证</a> ";
            //if (row.Record == null)
            //{
            //    c = " <a class='linkbtn'   onclick='GetVoucherNew(\"" + value + "\")'>凭证</a> ";
            //}
            //if (row.InvTypeDts == "支付职工薪酬")
            //{
            //    c = " <a class='linkbtn'   onclick='GetVoucherByEmployeeSalary(\"" + (RepDate+"/01") + "\")'>凭证</a> ";
            //}
        //} else {
        //    if (row.ThirdInvType == "增值税" || row.ThirdInvType=="所得税费用")
        //    {
        //        c = " <a class='linkbtn'   onclick='GetVoucher(\"" + value + '","' + row.Date + "\")'>凭证</a> ";
        //    }else 
        //    {
        //        c = " <a class='linkbtn'   onclick='GetVoucherInfoByEPId(\"" + row.AccountID + '","' + row.Date + "\")'>凭证</a> ";
        //    }
        //}

        //            var c
        //            var d
        //            if (row.IE_GUID == null) {
        ////                c = "<a class='linkbtn' onclick='RE1Click(\"" + row + "\")'>计入费用</a>";
        ////                d = "<a class='linkbtn' onclick='RE2Click(\"" + value + "\")'>计入成本外支出</a>";
        //            }
        //            if (row.IE_GUID !== null) {
        //                c = "";
        //                d = "";
        //            }
        if (row.Record == '已销账') {
            a = "";
            b = "";
            c = c + " <a class='linkbtn'   onclick='backCancelAccount(\"" + value + '","' + RepDate + '","' + ieguid + "\")'>反销账</a> ";
        }
        return a + " " + b + " " + c;

    };

    function GetVoucherByEmployeeSalary(id) {
        $('#VoucherTable').bootstrapTable("destroy");
        $('#VoucherTable').bootstrapTable({
            url: "/ExpenseQuery/GetEmployeeSalaryAccount?strDate=" + id + "&strType=0",
            method: 'get',
            pageSize: 30,
            pageList: [10, 20, 30, 50, 100, 200], // 自定义分页列表
            pageNumber: 1,
            singleSelect: true,
            clickToSelect: true,
            checkOnSelect: true,
            selectOnCheck: true,
            pagination: false,
            rownumbers: true,
            search: false, // 开启搜索功能
            showColumns: false,
            showRefresh: false,
            showQuery: false,
            showToggle: false,
            showExport: false,
            exportTypes: ['xml', 'txt', 'excel'],
            //detailView:true,
            columns: [
                { field: "InvTypeDts", title: '摘要' },
                { field: "Name", title: '会计科目', formatter: EmployeeSalaryFormat },
                { field: "AssetAmount", title: '借方金额', formatter: DecimalFmter },
                { field: "DebtAmount", title: '贷方金额', formatter: DecimalFmter }
            ]
        });

        var voucherDate
        var num
        var VoucherID
        //$.ajax({
        //    url: "/ExpenseQuery/GetVoucherID?id=" + id,
        //    async: false,
        //    dataType: "json",
        //    success: function (d) {
        //        voucherDate = d.VDate;
        //        num = d.id
        //    }
        //});
        //document.getElementById("VDate").innerText = voucherDate;
        //if (num.length == 1) {
        //    VoucherID = '第' + '00' + num + '号' + ' - 0001/0001';
        //}
        //if (num.length == 2) {
        //    VoucherID = '第' + '0' + num + '号' + ' - 0001/0001';
        //}
        //if (num.length >= 3) {
        //    VoucherID = '第' + num + '号' + ' - 0001/0001';
        //}
        //document.getElementById("num").innerText = VoucherID;
        $('#Voucher').modal({ show: true, backdrop: 'static' });
        $(".boxed-layout").css("padding-right", "0px");
    }


    var EmployeeSalaryFormat = function (value, row, index) {
        if (row.InvType == "银行存款") {
            return row.GeneralName + "-" + row.IEDA_GUID;
        } else {
            if (row.DetailedName && row.ThirdName) {
                return row.GeneralName + "-" + row.DetailedName + "-" + row.ThirdName;
            }
            if (row.DetailedName) {
                return row.GeneralName + "-" + row.DetailedName;
            }
        }
        return row.GeneralName;
    }

    var InvTypeHandle = function (value) {
        if (value == "" || value == null) {
            return '未归类';
        } else {
            return value;
        }
    };

    var DecimalFmter = function (s) {
        if (s == null || s == "undefined" || s == '0') {
            return "";
        }
        var h = '';
        s = s.toString();
        if (s.charAt(0) == '-') {
            h = '-';
            s = s.slice(1);
        }
        if (/[^0-9\.]/.test(s)) return "NaN";
        s = s.replace(/^(\d*)$/, "$1.");
        s = (s + "00").replace(/(\d*\.\d\d)\d*/, "$1");
        s = s.replace(".", ",");
        var re = /(\d)(\d{3},)/;
        while (re.test(s)) s = s.replace(re, "$1,$2");
        s = s.replace(/,(\d\d)$/, ".$1");
        return h + s.replace(/^\./, "0.");

    }

    var FJHandle = function (value, row, index) {
        if (value == "" || value == null) {
            return "";
        } else {
            var v = "../Content/EasyUI/themes/icons/hxz.png";
            //return '<img style=\"height: 100px;width: 100px;\" src=\""+v+"\"/>';
            return '<img style="height: 16px;width: 16px;" src="' + v + '" />';
        }
    };

    function GetVoucher(id, date) {
        $('#VoucherTable').bootstrapTable("destroy");
        $('#VoucherTable').bootstrapTable({
            url: "/VoucherQuery/GetALLVoucher?M_GUID="+id+"&Date="+DateHandle1(date),
            method: 'get',
            pageSize: 30,
            pageList: [10, 20, 30, 50, 100, 200], // 自定义分页列表
            pageNumber: 1,
            singleSelect: true,
            clickToSelect: true,
            checkOnSelect: true,
            selectOnCheck: true,
            pagination: false,
            rownumbers: true,
            search: false, // 开启搜索功能
            showColumns: false,
            showRefresh: false,
            showQuery: false,
            showToggle: false,
            showExport: false,
            exportTypes: ['xml', 'txt', 'excel'],
            //detailView:true,
            columns: [[
                { field: 'Summary', title: '摘要',formatter:Handle },
//                { field: 'id', title: '编号',formatter:check},
                { field: 'Date', title: '日期', formatter: DateHandle },
                { field: 'Name', title: '一级科目' ,formatter:Handle },
                { field: 'DetailName', title: '二级及明细科目',formatter:Handle1  },
                //{ field: 'ThName', title: '三级科目',formatter:Handle  },
                { field: 'DebitAmount', title: '借方金额',formatter:DecimalFmter},
				{ field: 'CreditAmount', title: '贷方金额',formatter:DecimalFmter}
            ]],
        });

//        var voucherDate
//        var num
//        var Str
//            $.ajax({
//                url: "/ExpenseQuery/GetVoucherID?id="+id,
//                async: false,
//                dataType: "json",
//                success: function (d) {
//                   voucherDate =d.VDate;
//                   num = d.id;
//                }
//            });
//         document.getElementById("VoucherDate").innerText = voucherDate;
//          if(num.length ==1){
//             Str = '第'+'00'+num+'号'+' - 0001/0001';
//         }
//        else if(num.length ==2){
//           Str = '第'+'0'+num+'号'+' - 0001/0001';
//         }else if(num.length >=3){
//            Str = '第'+num+'号'+' - 0001/0001';
//         }
//         document.getElementById("num").innerText = Str;
         $('#Voucher').modal({ show: true, backdrop: 'static' });
         $(".boxed-layout").css("padding-right", "0px");
     }
     var VoucherID
     var num
     var Handle = function(s,row,index){
        if(row.id !=null){
        if(row.id.toString().length ==1){
                 VoucherID='第'+'00'+row.id+'号'
                }
                if(row.id.toString().length ==2){
                 VoucherID='第'+'0'+row.id+'号'
                }
                else if(row.id.toString().length >2){
                 VoucherID='第'+row.id+'号'
                }
//                if(row.Flag=="E"){
//                    num="001/003";
//                }
//                 if(row.Flag=="I"){
//                    num="001/001";
//                }
//                 if(row.Flag=="R"){
//                    num="001/002";
//                }
//                 if(row.Flag=="P"){
//                    num="001/004";
//                }
//                 if(row.Flag=="DS"){
//                    num="001/005";
//                }
//                 if(row.Flag=="DC"){
//                    num="001/006";
//                }
//                VoucherID = VoucherID+'-'+num;
                 document.getElementById("num").innerText = VoucherID;
          }
        if (s == null || s == "undefined" || s=='0') {
            return "";
        }
        return s;
        }
         
//        var check =function(value,row,index){
//            if(value==null){
//                return "";
//            }if(row.Summary=="附单据数     张")
//            {
//                return ChinaCost(value);
//            }
//            else{
//                if(value.toString().length ==1){
//                 VoucherID='第'+'00'+value+'号'
//                }
//                if(value.toString().length ==2){
//                 VoucherID='第'+'0'+value+'号'
//                }
//                else if(value.toString().length >2){
//                 VoucherID='第'+value+'号'
//                }
//                if(row.Flag=="E"){
//                    num="001/003";
//                }
//                 if(row.Flag=="I"){
//                    num="001/001";
//                }
//                 if(row.Flag=="R"){
//                    num="001/002";
//                }
//                 if(row.Flag=="P"){
//                    num="001/004";
//                }
//                 if(row.Flag=="DS"){
//                    num="001/005";
//                }
//                 if(row.Flag=="DC"){
//                    num="001/006";
//                }
//                VoucherID = VoucherID+'-'+num;
//            document.getElementById("num").innerText = VoucherID;
//            return  VoucherID
//            }
//        }
     function GetVoucherNew(id) {
         $('#VoucherTable').bootstrapTable({
             url: "/PaymentClassify/GetRPVoucherNew?RP_GUID=" + id,
             method: 'get',
             pageSize: 30,
             pageList: [10, 20, 30, 50, 100, 200], // 自定义分页列表
             pageNumber: 1,
             singleSelect: true,
             clickToSelect: true,
             checkOnSelect: true,
             selectOnCheck: true,
             pagination: false,
             rownumbers: true,
             search: false, // 开启搜索功能
             showColumns: false,
             showRefresh: false,
             showQuery: false,
             showToggle: false,
             showExport: false,
             exportTypes: ['xml', 'txt', 'excel'],
             //detailView:true,
             columns: [
                 { field: "Summary", title: '摘要' },
                 { field: "Name", title: '会计科目', formatter: ChinaCost },
                 { field: "DebitAmount", title: '借方金额', formatter: DecimalFmter },
                 { field: "CreditAmount", title: '贷方金额', formatter: DecimalFmter }
             ],
         });

         var voucherDate
         var num
         var Str
         $.ajax({
             url: "/ExpenseQuery/GetVoucherID?id=" + id,
             async: false,
             dataType: "json",
             success: function (d) {
                 voucherDate = d.VDate;
                 num = d.id;
             }
         });
         document.getElementById("VoucherDate").innerText = voucherDate;
         if (num.length == 1) {
             Str = '第' + '00' + num + '号' + ' - 0001/0001';
         }
         else if (num.length == 2) {
             Str = '第' + '0' + num + '号' + ' - 0001/0001';
         } else if (num.length >= 3) {
             Str = '第' + num + '号' + ' - 0001/0001';
         }
         document.getElementById("num").innerText = '测试';
         $('#Voucher').modal({ show: true, backdrop: 'static' });
         $(".boxed-layout").css("padding-right", "0px");
     }
     function GetVoucherInfoByEPId(id, date) {
         $('#VoucherTable').bootstrapTable("destroy");
        $('#VoucherTable').bootstrapTable({
            url: "/VoucherQuery/GetVoucherInfo?VouchID=" + id + "&Date=" + DateHandle1(date),
            method: 'get',
            pageSize: 30,
            pageList: [10, 20, 30, 50, 100, 200], // 自定义分页列表
            pageNumber: 1,
            singleSelect: true,
            clickToSelect: true,
            checkOnSelect: true,
            selectOnCheck: true,
            pagination: false,
            rownumbers: true,
            search: false, // 开启搜索功能
            showColumns: false,
            showRefresh: false,
            showQuery: false,
            showToggle: false,
            showExport: false,
            exportTypes: ['xml', 'txt', 'excel'],
            //detailView:true,
            columns: [[
                { field: 'Summary', title: '摘要', formatter: Handle },
                { field: 'id', title: '编号', formatter: check },
                { field: 'Date', title: '日期', formatter: DateHandle },
                { field: 'Name', title: '一级科目', formatter: Handle },
                { field: 'DetailName', title: '二级及明细科目', formatter: Handle1 },
                //{ field: 'ThName', title: '三级科目', formatter: Handle },
                { field: 'DebitAmount', title: '借方金额', formatter: DecimalFmter },
				{ field: 'CreditAmount', title: '贷方金额', formatter: DecimalFmter }
            ]],
        });

        $('#Voucher').modal({ show: true, backdrop: 'static' });
        $(".boxed-layout").css("padding-right", "0px");
    }
     var Handle1 = function(s,row,index)
    {
        if(row.Summary !=null&&row.Summary.indexOf("附单") != -1)
            {
                return ChinaCost(row.DebitAmount);
            }
        if (s == null || s == "undefined" || s=='0') {
            return "";
        }else {
            if(row.ThName == null || row.ThName == "undefined" || row.ThName=='0')
               {return s;} else{
                s = s+"-"+row.ThName;
               }
        }
        return s;
    }
    var showName = function (value, row, index) {
        if (row.InvType == "银行存款") {
            return row.GeneralName + "-" + row.IEDA_GUID;
        } else {
            if (row.DetailedName && row.ThirdName ) {
                return row.GeneralName + "-" + row.DetailedName + "-" + row.ThirdName;
            }
            if (row.DetailedName) {
                return row.GeneralName + "-" + row.DetailedName;
            }
        }
        return row.GeneralName;
    }
//    function query() { 

//        $('#PayList').bootstrapTable('refresh');
//    }
    var name
    function ShowModel() {
   
    
     document.getElementById("model_table").style.display = "none";
     if($('#PayList').bootstrapTable("getSelections") == ''){
        alert("请先选择付款记录")
     }else{
     $('#amyModal').modal({ show: true, backdrop: 'static' });
     $(".boxed-layout").css("padding-right", "0px");
     $('#amyModal').draggable();
     var div_array = document.getElementsByName("bt");
        for(i=0;i<div_array.length;i++)
        {
        div_array[i].style.display = "none";
        }
  
    var row = $('#PayList').bootstrapTable("getSelections");
        var TypeDts = row[0].InvTypeDts;
        name = row[0].RPer;
        if(TypeDts!==null){
          document.getElementById("model_table").style.display = "block";
            $('#aTable').bootstrapTable('destroy'); 
          if (TypeDts == "购买商品、接受服务所支付的款") {
          document.getElementById("b1").style.display = "block";
//            url ='/PaymentRecord/GetUnionList?customer=' + name;
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('营业成本') + "&customer="+ name;
        }else if(TypeDts == "支付管理费用"){
            document.getElementById("b12").style.display = "block";
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('管理费用') + "&customer="+ name;
        }else if(TypeDts == "支付财务费用"){
            document.getElementById("b10").style.display = "block";
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('财务费用') + "&customer="+ name;
        }else if(TypeDts == "支付销售费用"){
            document.getElementById("b13").style.display = "block";
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('销售费用') + "&customer="+ name;
        }
        else if(TypeDts == "支付其他业务成本"){
            document.getElementById("b14").style.display = "block";
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('其他业务成本') + "&customer="+ name;
        }else if(TypeDts == "支付营业外支出"){
            document.getElementById("b15").style.display = "block";
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('营业外支出') + "&customer="+ name;
        }else if (TypeDts == "支付押金") {
             document.getElementById("b2").style.display = "block";          
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('支付押金') + "&customer="+ name;
        }else if (TypeDts == "支付暂支借款") {
             document.getElementById("b17").style.display = "block";          
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('支付暂支借款') + "&customer="+ name;
        }else if (TypeDts == "归还其它公司支付的押金") {
             document.getElementById("b18").style.display = "block";          
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('归还其它公司支付的押金') + "&customer="+ name;
        }  else if (TypeDts == "预付供应商账款") {
             document.getElementById("b4").style.display = "block";          
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('预付供应商账款') + "&customer="+ name;
        }else if (TypeDts == "支付其他与经营活动有关的款") {
             document.getElementById("b11").style.display = "block";
             url = '/PaymentRecord/GetUnionList?customer=' + name + "&InvType=" + escape('财务费用');
        }else if (TypeDts == "短期投资支出") {
             document.getElementById("b6").style.display = "block";
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('短期投资支出') + "&customer="+ name;
        } else if (TypeDts == "长期股权投资支出") {
             document.getElementById("b21").style.display = "block";
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('长期股权投资支出') + "&customer="+ name;
        } else if (TypeDts == "长期债券投资支出") {
             document.getElementById("b22").style.display = "block";
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('长期债券投资支出') + "&customer="+ name;
        } else if (TypeDts == "购买固定资产所支付的款") {
            document.getElementById("b7").style.display = "block";
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('固定资产') + "&customer="+ name;
        } else if (TypeDts == "购买无形资产所支付的款") {
            document.getElementById("b19").style.display = "block";
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('无形资产') + "&customer="+ name;
        }else if (TypeDts == "购买其他长期资产所支付的款") {
            document.getElementById("b20").style.display = "block";
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('其他长期资产') + "&customer="+ name;
        }else if (TypeDts == "归还短期借款所支付的款") {
          document.getElementById("b8").style.display = "block";  
          url = '/ReceivablesDeclareCustomer/ChooseReceivablesDeclareCustomerList?record='+ escape('未还款')+"&flag="+"P"+ "&customer="+ name;
        } else if (TypeDts == "归还长期借款所支付的款") {
          document.getElementById("b23").style.display = "block";  
          url = '/ReceivablesDeclareCustomer/ChooseReceivablesDeclareCustomerList?record='+ escape('未还款')+"&flag="+"P"+ "&customer="+ name;
        }  else if (TypeDts == "投资所支付款") {
             document.getElementById("b6").style.display = "block";
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('投资支出') + "&customer="+ name;
        }  else if (TypeDts == "短期投资支出") {
             document.getElementById("b6").style.display = "block";
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('短期投资支出') + "&customer="+ name;
        } else if (TypeDts == "长期股权投资支出") {
             document.getElementById("b21").style.display = "block";
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('长期股权投资支出') + "&customer="+ name;
        } else if (TypeDts == "长期债券投资支出") {
             document.getElementById("b22").style.display = "block";
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('长期债券投资支出') + "&customer="+ name;
        } else if (TypeDts == "购买固定资产所支付的款") {
            document.getElementById("b7").style.display = "block";
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('固定资产') + "&customer="+ name;
        } else if (TypeDts == "购买无形资产所支付的款") {
            document.getElementById("b19").style.display = "block";
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('无形资产') + "&customer="+ name;
        }else if (TypeDts == "购买其他长期资产所支付的款") {
            document.getElementById("b20").style.display = "block";
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('其他长期资产') + "&customer="+ name;
//        }else if (TypeDts == "购买固定资产、无形资产和其他长期资产所支付的款") {
//            document.getElementById("b7").style.display = "block";
//            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('资产采购') + "&customer="+ name;
//        } else if (TypeDts == "归还债务所支付的款") {
//            document.getElementById("b8").style.display = "block";
//            url = '/ReceivablesDeclareCustomer/ChooseReceivablesDeclareCustomerList?record='+ escape('未还款')+"&flag="+"P"+ "&customer="+ name;
//        } else if (TypeDts == "分配股利、利润的款") {
            document.getElementById("b9").style.display = "block";
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('分配股利、利润') + "&customer="+ name;
        }else if (TypeDts == "归还短期借款所支付的款") {
          document.getElementById("b8").style.display = "block";  
          url = '/ReceivablesDeclareCustomer/ChooseReceivablesDeclareCustomerList?record='+ escape('未还款')+"&flag="+"P"+ "&customer="+ name;
        } else if (TypeDts == "归还长期借款所支付的款") {
          document.getElementById("b23").style.display = "block";  
          url = '/ReceivablesDeclareCustomer/ChooseReceivablesDeclareCustomerList?record='+ escape('未还款')+"&flag="+"P"+ "&customer="+ name;
        } else if (TypeDts == "分配利润、股利所支付的款") {
             document.getElementById("b9").style.display = "block";    
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('分配利润、股利所支付的款') + "&customer="+ name;
        }else if (TypeDts == "偿付利息所支付的款") {
            document.getElementById("b16").style.display = "block";
             url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('偿付利息所支付的款') + "&customer="+ name;
        }else if (TypeDts == "支付职工薪酬") {
           document.getElementById("b3").style.display = "block";
           url = '/WageCostsRecord/GetWageCostList?state=' + escape('未付');
        } else if (TypeDts == "支付的各项税费") {
             document.getElementById("b5").style.display = "block";
             url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('税费');
        }
            var columns = new Array();
            columns.push({ field: 'ck', checkbox: true, title: '选择', width: '50' });
           if(TypeDts == "支付职工薪酬"){
            columns.push({ field: 'Employee', title: '姓名', width: 70, align: 'center' });
            columns.push({ field: 'Date', title: '认定日期', width: '110', align: 'center', formatter: DateHandle });
            columns.push({ field: 'Total', title: '总金额', width: 70, align: 'center', formatter: DecimalFmter });
            columns.push({ field: 'W_GUID', title: '未销金额', width: 70, formatter: LinkHandleResidualAmount, align: 'center' });
            }else{
            columns.push({ field: 'RPerName', title: '@FMS.Resource.Finance.Finance.Payee', align: 'center' });
            
            columns.push({ field: 'InvType', title: '付款类别', align: 'center' });
              columns.push({ field: 'Amount', title: '付款金额', align: 'center', formatter: DecimalFmter });
            if(arr1.indexOf(TypeDts)>-1){
                columns.push({ field: 'InvType', title: '费用类别', align: 'center' });
                columns.push({ field: 'IEGroup', title: '费用详细类别', align: 'center' });
                columns.push({ field: 'IE_GUID', title: '未销金额', formatter:LinkHandleResidualAmount,align: 'center' });
                columns.push({ field: 'Remark', title: '备注', align: 'center' });
                columns.push({ field: 'InvNo', title: '@FMS.Resource.Finance.Finance.InvNo', align: 'center' });
            }if(arr2.indexOf(TypeDts)>-1){
          
                columns.push({ field: 'GUID', title: '未销金额', formatter: LinkHandleResidualAmount, align: 'center' });
                 columns.push({ field: 'Remark', title: '备注', align: 'center' });
                columns.push({ field: 'VoucherNo', title: '@FMS.Resource.Finance.Finance.InvNo', align: 'center' });
            }
            if(TypeDts== "归还债务所支付的款"){
                 columns.push({ field: 'GUID', title: '未销金额', formatter: LinkResidualAmount, align: 'center' });
                  columns.push({ field: 'Remark', title: '备注', align: 'center' });
                columns.push({ field: 'InvNo', title: '@FMS.Resource.Finance.Finance.InvNo', align: 'center' });
            }
            }
            $('#aTable').bootstrapTable('destroy'); 
            $('#aTable').bootstrapTable({
                url: url,
                method: 'get',
                pageSize: 5,
                pageList: [5, 10, 25, 50, 100, 200], // 自定义分页列表
                pageNumber: 1,
                clickToSelect: true,
                checkOnSelect: true,
                selectOnCheck: true,
                pagination: true,
                sortName: 'AffirmDate', // 设置默认排序为 name
                sortOrder: 'desc', // 设置排序为反序 desc
                search: false,
                showColumns: true,
                showRefresh: false,
                showQuery: false,
                showToggle: false,
                showExport: false,
                exportTypes: ['xml', 'txt', 'excel'],
                columns: columns,
	            onCheck: function (row) {
                 var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord.length!=0){
		          document.getElementById("button4").removeAttribute('disabled');
                  }else{
                  document.getElementById("button4").removeAttribute('disabled');
                  }
	            },
                onUncheck: function (row) {
                  var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord != 0){
                 document.getElementById("button4").removeAttribute('disabled');
		       
	            }else{
                 document.getElementById("button4").disabled  = "true";
                }
                },
                onCheckAll: function (row) {
                  var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord != 0){
                 document.getElementById("button4").removeAttribute('disabled');
		       
	            }else{
                 document.getElementById("button4").disabled  = "true";
                }
                },
                onUncheckAll: function (row) {
                  var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord != 0){
                 document.getElementById("button4").removeAttribute('disabled');
		       
	            }else{
                 document.getElementById("button4").disabled  = "true";
                }
                }
            });


        }else{
          document.getElementById("IncomeGroup").style.display = "block";
        }
       }
    }

    var DateHandle = function (jsondate) {
       jsondate = jsondate.replace("/Date(", "").replace(")/", "");
       if(jsondate<0){return ""};
        if (jsondate.indexOf("+") > 0) {
            jsondate = jsondate.substring(0, jsondate.indexOf("+"));
        } else if (jsondate.indexOf("-") > 0) {
            jsondate = jsondate.substring(0, jsondate.indexOf("-"));
        }

        var date = new Date(parseInt(jsondate, 10));
        var month = date.getMonth() + 1 < 10 ? "0" + (date.getMonth() + 1) : date.getMonth() + 1;
        var currentDate = date.getDate() < 10 ? "0" + date.getDate() : date.getDate();
        return date.getFullYear() + "/" + month + "/" + currentDate;
    }
     function DateChange(jsondate) {
        jsondate = jsondate.replace("/Date(", "").replace(")/", "");
        if (jsondate.indexOf("+") > 0) {
            jsondate = jsondate.substring(0, jsondate.indexOf("+"));
        }
        else if (jsondate.indexOf("-") > 0) {
            jsondate = jsondate.substring(0, jsondate.indexOf("-"));
        }

        var date = new Date(parseInt(jsondate, 10));
        var month = date.getMonth() + 1 < 10 ? "0" + (date.getMonth() + 1) : date.getMonth() + 1;
        var currentDate = date.getDate() < 10 ? "0" + date.getDate() : date.getDate();
        return date.getFullYear() + "/" + month + "/" + currentDate;
    }
     var LinkHandleResidualAmount = function (value, row, index) {
        if (row.DisAmount < 0) {
            var link1 = "<a class='' >  \ " + "" + "\</a>"
        }
        else if (row.DisAmount >= 0) {
            var link1 = "<a class=''>  \ " + row.DisAmount + "\</a>"
        }
        return link1;
    };
     var LinkResidualAmount = function (value, row, index) {
        if (row.DisAmount1 < 0) {
            var link1 = "<a class='' >  \ " + "" + "\</a>"
        }
        else if (row.DisAmount1 >= 0) {
            var link1 = "<a class=''>  \ " + row.DisAmount1 + "\</a>"
        }
        return link1;
    };
    
    function InitSelct(obj, nonText) {
        obj.multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: true,
            includeFilterNewBtn: false,
            nonSelectedText: nonText

        });
        obj.val("").multiselect("refresh");
    }
     var flag;
     var detailType;
     var str;
     var type;
    function RE1Click(value){
        var TypeDts 
        var d = new Date();
        type = value;
        document.getElementById("button1").disabled  = "true";
        document.getElementById("AddIncome").style.display = "none";
        document.getElementById("IncomeCategory").style.display = "none";
        document.getElementById("IncomeAdd").style.display = "none";
        $('#AddIncome').modal({ show: true, backdrop: 'static' });
        $(".boxed-layout").css("padding-right", "0px");
        $('#AddIncome').draggable();
        var row = $('#PayList').bootstrapTable("getSelections");
        if (row[0].InvTypeDts == null) {
            TypeDts = $("input[name='TypeDts']:checked").val();
        } else {
            TypeDts = row[0].InvTypeDts;
        }   
        if(EType.indexOf(value)>-1){
        document.getElementById("IncomeAdd").style.display = "block";
        document.getElementById("IncomeCategory").style.display = "none";
        document.getElementById("button1").removeAttribute('disabled');
        InitSelect($("#IEGroup"),"");
           





        $.ajax({
            url:"/GeneralLedgerAccount/GetDetailSubject?Name="+value,
            async: false,
            dataType: "json",
            success: function (d) {
            
                detailType = d;
               detailType.splice(0, 1);
            },
            error:function(a,b,c){
              
                alert(a);





            }
        });
        
        $("#Profit_Name").val(value);
        $("#IEGroup").multiselect('dataprovider', detailType);  
        $("#IEGroup").val("").multiselect("refresh");
        $("#IEGroup").val(row[0].DetailInvTypeID);
        $("#IEGroup").multiselect("refresh");
        $("#InvType").val(value);
        var row = $('#PayList').bootstrapTable("getSelections");
        $('#Amount').val(row[0].DisAmount);
        $('#SumAmount').val(row[0].DisAmount);
        $("#autocomplete1").val(row[0].RPerName);
        $("#Log1").val(row[0].RPer);
        $("#AffirmDate").val(row[0].Date);
        $("#InvNo").val(row[0].InvNo);
        var guid = NewGUID(); 
        $("#IE_GUID1").val(guid);
        //$("#AddIncome #GUID").val(guid);






        $("#IE_Flag").val("E");
        IntiFileUpload("#certificate", guid);
        }
        if(TypeDts == '支付职工或为职工支付的款'){
        document.getElementById("WCRecordAdd").style.display = "block";
        document.getElementById("IncomeCategory").style.display = "none";
        document.getElementById("button1").removeAttribute('disabled');
        
        $("#WCRecordAdd #InvType").multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: true,
            includeFilterNewBtn: false,
            nonSelectedText: ''

        });
        $("#WCRecordAdd #InvType").val("").multiselect("refresh");
        
        $("#WCRecordAdd #PRCurrency").multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: true,
            includeFilterNewBtn: false,
            nonSelectedText: ''

        });
        $("#WCRecordAdd #PRCurrency").multiselect('dataprovider', currency);
        $("#WCRecordAdd #PRCurrency").val("").multiselect('refresh');
        $("#WCRecordAdd #PRCurrency").multiselect('select', standardCoin);
        var guid = NewGUID();
        
        var str = d.getFullYear()+"/"+(d.getMonth()+1)+"/"+d.getDate();
        $("#WCRecordAdd #Employee").val(row[0].Remark);
         $("#WCRecordAdd #PRCurrency").val(row[0].Currency);
         $("#WCRecordAdd #Total").val(row[0].DisAmount);
         $("#WCRecordAdd #AffirmDate").val(str);
        $("#WCRecordAdd #IE_GUID").val(guid);
        $("#WCRecordAdd #W_GUID").val(guid);
        type = "工资成本";
        }
        if(TypeDts == '支付的各项税费'){
        document.getElementById("TaxRecordAdd").style.display = "block";
        document.getElementById("IncomeCategory").style.display = "none";
        document.getElementById("button1").removeAttribute('disabled');
         $('#TaxRecordAdd #Currency').multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: true,
            includeFilterNewBtn: false

        });
        $("#TaxRecordAdd #Currency").multiselect('dataprovider', currency);
        $("#TaxRecordAdd #Currency").val("").multiselect('refresh');
        $("#TaxRecordAdd #Currency").multiselect('select', standardCoin);

        var detailType
        $.ajax({
            url: "/InternalAPI/GetDetailType?coloum=" + "TaxFlag",
            async: false,
            dataType: "json",
            success: function (d) {

                detailType = d;
            },
            error: function (a, b, c) {

                alert(a);
            }
        });
        $('#TaxRecordAdd #IEGroup').multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: true,
            includeFilterNewBtn: false,
            nonSelectedText: ''

        });
        $("#TaxRecordAdd #IEGroup").multiselect('dataprovider', detailType);
        $("#TaxRecordAdd #IEGroup").val("").multiselect("refresh");
        var str = d.getFullYear()+"/"+(d.getMonth()+1)+"/"+d.getDate();
        var guid;
        var guid = NewGUID();
        $("#TaxRecordAdd #IE_GUID").val(guid);
        $("#TaxRecordAdd #SumAmount").val(row[0].DisAmount);
        $("#TaxRecordAdd #Currency").val(row[0].Currency);
        $("#TaxRecordAdd #AffirmDate").val(str);
        type = "税费";
        $("#TaxRecordAdd #InvType").val(type);
        }


      
    
    }
  
    function fn(str){
     var sumAmount = str.replace(",", "")
     return sumAmount;
    }

    var aa;
    var arr3=["支付押金","支付暂支借款","短期投资支出","长期股权投资支出","长期债权投资支出"]
    var arr4=["归还其它公司支付的押金","归还短期借款所支付的款","归还长期借款所支付的款"]
    function RE2Click(Type){
        var guid = NewGUID();
        document.getElementById("button2").removeAttribute('disabled');
        var row = $('#PayList').bootstrapTable("getSelections");
        var TypeDts = row[0].InvTypeDts;
        var amount =fn(Money(row[0].DisAmount));
        var list = new Array();
        var pay = new Object;
            pay.GUID = guid;
            pay.RPer = row[0].RPer;
            pay.Currency = row[0].Currency;
            pay.Date = row[0].Date;
            pay.RPTypeID = row[0].RPTypeID;
            pay.DetailRPTypeID = row[0].DetailRPTypeID;
            pay.Amount = amount;


            pay.State = "已付";
            pay.Record = "未记录";
            pay.InvType = Type;
            list.push(pay);
            var param = new Array()
        param = { payList: list};

        if(arr3.indexOf(Type)>-1){
            $.ajax({
            cache: true,
            type:"POST",
            url: "/ReceivablesDeclareCustomer/CreatPDRecord",
            contentType: 'application/json',
            dataType: 'html',
            data: JSON.stringify(param),
            async: false,
            success: function (data) {
                var rs = JSON.parse(data);
                if (rs.Result == true){
                $('#certificate').fileinput('upload');
                var ieguid = guid
                var rpguid =row[0].RP_GUID;
                  $.ajax({
	                    url: '/PaymentClassify/UpRecPayType?id=' + rpguid + '&ieguid='+ieguid  +'&type='+Type+'&SumAmount='+amount,
	                    type: "POST",
                        success: function (data) {
                        var res = JSON.parse(data)
                         if(res.success){
                         $('#amyModal').modal('hide');
                         $('#PayList').bootstrapTable('refresh', { url: "/PaymentClassify/GetPaymentList" });
                        alert("计入成功");
                        }else{
                        alert("计入失败");
                        }
                        },
                        error: function (request) {
                          alert("计入失败");
                }
	                });
                     
                }else{
                    alert("计入失败");
                }

            }
        });

        }else{
         $.ajax({
            cache: true,
            type:"POST",
            url: "/PaymentDeclareCostSpending/CreatPDRecord",
            contentType: 'application/json',
            dataType: 'html',
            data: JSON.stringify(param),
            async: false,
            success: function (data) {
                var rs = JSON.parse(data);
                if (rs.Result == true){
                $('#certificate').fileinput('upload');
                var ieguid = guid
                var rpguid =row[0].RP_GUID;
                  $.ajax({
	                    url: '/PaymentClassify/UpRecPayType?id=' + rpguid + '&ieguid='+ieguid  +'&type='+Type+'&SumAmount='+amount,
	                    type: "POST",
                        success: function (data) {
                        var res = JSON.parse(data)
                         if(res.success){
                         $('#amyModal').modal('hide');
                         $('#PayList').bootstrapTable('refresh', { url: "/PaymentClassify/GetPaymentList" });
                        alert("计入成功");
                        }else{
                        alert("计入失败");
                        }
                        },
                        error: function (request) {
                          alert("计入失败");
                }
	                });
                     
                }else{
                    alert("计入失败");
                }

            }
        });
        }
    }


    function ISubmit1() {
        $.ajax({
            cache: true,
            type: "POST",
            url: "/PaymentDeclareCostSpending/UpdPaymentDeclareCostSpending",
            data: $('#altForm').serialize(),
            async: false,
            onSubmit: function () {
                return $("#altForm").form('validate');
            },
            error: function (request) {
                alert("Connection error");
            },
            success: function (data) {
                if (data == "操作成功！") {
                    $('#certificate').fileinput('upload');
                    var ieguid = $("#AddDcSpending #GUID").val();
                    var rpguid = aa.RP_GUID;
                    var type = $("#AddDcSpending #InvType").val();
                    $.ajax({
                        url: '/PaymentClassify/UpRecPayType?id=' + rpguid + '&ieguid=' + ieguid + '&type=' + type,
                        type: "POST",
                        success: function (data) {
                            var res = JSON.parse(data)
                            if (res.success) {
                                document.getElementById("amyModal").style.display = "none";
                                $('#PayList').bootstrapTable('refresh', { url: "/PaymentClassify/GetPaymentList" });
                                alert("计入成本外支出成功");
                            }
                        },
                        error: function (request) {
                            alert("计入成本外支出失败");
                        }
                    });

                } else {
                    alert("提交失败");
                }

            }
        });
    }
    var flag;
    var type;
    function NextIncome() {
        document.getElementById("button1").removeAttribute('disabled');
        document.getElementById("IncomeAdd").style.display = "block";
        $("input[type=reset]").trigger("click");
        document.getElementById("IncomeCategory").style.display = "none";
        InitSelect($("#IEGroup"), "");
        if ($("#IncomeCategory  input[type='radio']:checked").val() == "记录营业成本") {
            flag = "ExpenseFlag";
            type = "营业成本";
        }
        if ($("#IncomeCategory  input[type='radio']:checked").val() == "记录销售费用") {
            flag = "SaleFlag";
            type = "销售费用";
        }
        if ($("#IncomeCategory  input[type='radio']:checked").val() == "记录管理费用") {
            flag = "ManageFlag";
            type = "管理费用";
        }
        if ($("#IncomeCategory  input[type='radio']:checked").val() == "记录财务费用") {
            flag = "FinanceFlag";
            type = "财务费用";
        }
        if ($("#IncomeCategory  input[type='radio']:checked").val() == "记录工资成本") {
            flag = "SalaryFlag";
            type = "工资成本";
        }
        if ($("#IncomeCategory  input[type='radio']:checked").val() == "税费") {
            flag = "TaxFlag";
            type = "税费";
        }
        $.ajax({
            url: "/InternalAPI/GetDetailType?coloum=" + flag,
            async: false,
            dataType: "json",
            success: function (d) {

                detailType = d;
            },
            error: function (a, b, c) {

                alert(a);
            }
        });
        if (type == '营业成本') {
            $('#Profit_GUID').val('51BFDD3E-2253-4FBF-A946-19C18C25C6FC')
        }
        if (type == '销售费用') {
            $('#Profit_GUID').val('DC83D8A5-31F6-4DFE-B093-87F90A234E53')
        }
        if (type == '管理费用') {
            $('#Profit_GUID').val('547E5A1A-1C20-4249-92C8-67FFFFBD38E7')
        }
        $("#IEGroup").multiselect('dataprovider', detailType);
        $("#IEGroup").val("").multiselect("refresh");
        $("#InvType").val(type);
        var row = $('#PayList').bootstrapTable("getSelections");
        $('#Amount').val(row[0].SumAmount);
        $('#SumAmount').val(row[0].SumAmount);
        $("#autocomplete1").val(row[0].RPerName);
        $("#Log1").val(row[0].RPer);
        $("#AffirmDate").val(row[0].Date);
        $("#InvNo").val(row[0].InvNo);
        var guid = NewGUID();
        $("#IE_GUID1").val(guid);
        $("#AddIncome #GUID").val(guid);
        $("#IE_Flag").val("E");
        IntiFileUpload("#certificate", guid);

    }
    function NewGUID() {
        var GUID;
        $.ajax({
            url: "/ReceivablesRecord/NewGuid",
            async: false,
            dataType: "text",
            success: function (d) {
                GUID = d.toString();
            }
        });
        return GUID;
    }
  function ISubmit() {
  var addstyle;
  var row = $('#PayList').bootstrapTable("getSelections");
  $('#RPType').val(row[0].PayCategoryID);
  $('#DetailRPType').val(row[0].DetailRPTypeID);
  if(EType.indexOf(type)>-1){
      var rper;
      var sumAmount = document.getElementById('SumAmount').value;
        sumAmount = sumAmount.replace(",", "");
        $("#SumAmount1").val(sumAmount);
        $.ajax({
            url: "/InternalAPI/GetPayeeJson",
            async: false,
            dataType: "json",
            success: function (d) {
                for (var i = 0; i < d.length; i++) {
                    d[i]["id"] = d[i]["value"];
                    d[i]["value"] = d[i]["label"];

                }
                rper = d;
            }
        });
        var log = $("#Log1").val();
        var log_a = "";
        for (var j = 0; j < rper.length; j++) {//通过length属性获取数组长度，循环遍历数组元素
            if (rper[j]["id"] == log) {//通过==比较数组元素是否和变量a的值相等
                log_a = 1;
            }
        }
        if (log_a!=1) {
            $("#Log1").val("");
        }
       
        var affirmDate = $("#AffirmDate").val();
        var date = $("#Date").val();
      /////////新增编辑
        var RepDate = affirmDate.substr(0, 7);
      //判断是否结账
        $.ajax({
            url: "/IncomeStatement/isCheckout?RepDate=" + RepDate + "&status=已结账",
            type: "POST",
            success: function (data) {
                if ($.parseJSON(data).Result) {
                    if (Date.parse(affirmDate) > Date.parse(date)) {
                        alert("收入确认日期不能大于收入截止日期，请重新选择！");
                    } else {
                        $.ajax({
                            cache: true,
                            type: "POST",
                            url: "/ExpenseRecord/UpdExpenseRecord",
                            data: $('#Expense_Form').serialize(),
                            async: false,
                            onSubmit: function () {
                                return $("#Expense_Form").form('validate');
                            },
                            error: function (request) {
                                alert("计入失败");
                            },
                            success: function (data) {

                                //提交成功，开始上传附件
                                //                    for (var i = 1; i < 20; i++) {
                                //                        $('.file_upload').fileinput('upload');
                                //                    }
                                //                    $('.file_upload').fileinput('clear');
                                //$('#Income_Form')[0].reset();
                                var res = JSON.parse(data)
                                if (res.success) {
                                    $('.file_upload').fileinput('upload');

                                    var row = $('#PayList').bootstrapTable("getSelections");
                                    var rpguid = row[0].RP_GUID;
                                    var ieguid = $("#IE_GUID1").val();
                                    if (row[0].InvTypeDts == '支付其他与经营活动有关的款') {
                                        type = '预付供应商';
                                    }

                                    $.ajax({
                                        url: '/PaymentClassify/UpRecPayType?id=' + rpguid + '&ieguid=' + ieguid + '&type=' + type+'&SumAmount='+sumAmount,
                                        type: "POST",
                                        success: function (data) {
                                            var res = JSON.parse(data)
                                            if (res.success) {
                                                $("input[type=reset]").trigger("click");
                                                document.getElementById("IncomeAdd").style.display = "none";
                                                $('#amyModal').modal('hide');
                                                $("#PayList").bootstrapTable('refresh', { url: "/PaymentClassify/GetPaymentList"}); 
                                                alert("计入成功");
                                            }
                                        },
                                        error: function (request) {
                                            alert("计入失败");
                                        }
                                    });
                                }

                            }
                        });

                    }
                } else {
                    alert("该月账单已结账，如需操作请先反结账该月账单！");
                    return false;
                }
            },
            error: function () {
                alert("服务器异常");
            }
        });
        
  }
  var r = true;
        if(type =='工资成本'){
        if ($("#WCRecordAdd #InvType").val() == '营业成本') {
                $("#WCRecordAdd #Profit_GUID").val('51BFDD3E-2253-4FBF-A946-19C18C25C6FC')
            }
            if ($("#WCRecordAdd #InvType").val() == '销售费用') {
                $("#WCRecordAdd #Profit_GUID").val('DC83D8A5-31F6-4DFE-B093-87F90A234E53')
            } 
            if ($("#WCRecordAdd #InvType").val() == '管理费用') {
                $("#WCRecordAdd #Profit_GUID").val('547E5A1A-1C20-4249-92C8-67FFFFBD38E7')
            } 
         var list = new Array();
         var pay = new Object;
            pay.IE_GUID = $("#WCRecordAdd #IE_GUID").val();
            pay.W_GUID = $("#WCRecordAdd #W_GUID").val();
            pay.Currency = $("#WCRecordAdd #PRCurrency").val();
            pay.Date = $("#WCRecordAdd #AffirmDate").val();
            var RepDate = pay.Date.substr(0, 7);
            //判断是否结账
            $.ajax({
                url: "/IncomeStatement/isCheckout?RepDate=" + RepDate + "&status=已结账",
                type: "POST",
                async: false,
                success: function (data) {
                    if ($.parseJSON(data).Result) {

                    } else {
                        alert("该月账单已结账，如需操作请先反结账该月账单！");
                        r = false;
                    }
                },
                error: function () {
                    alert("服务器异常");
                }
            });
            pay.InvType = $("#WCRecordAdd #InvType").val();
            pay.Total = $("#WCRecordAdd #Total").val();
            pay.State = $("#WCRecordAdd #State").val();
            pay.Employee = $("#WCRecordAdd #Employee").val();
            pay.Profit_GUID = $("#WCRecordAdd #Profit_GUID").val();
            list.push(pay);
            var param = new Array()
            addstyle = 1;
            param = { payList: list, addstyle: addstyle };
            if (!r) return false;
            var sumAmount = $("#WCRecordAdd #Total").val();
            $.ajax({
                cache: true,
                type: "POST",
                url: '/WageCostsRecord/UpdWageCostsRecord',
                async: false,
                contentType: 'application/json',
                dataType: 'html',
                data: JSON.stringify(param),
                success: function (data) {
                    var rs = JSON.parse(data);
                    if (rs.Result == true) {
                        var row = $('#PayList').bootstrapTable("getSelections");
                        var rpguid = row[0].RP_GUID;
                        var ieguid = $("#WCRecordAdd #IE_GUID").val();
                        var type = "工资成本"

                        $.ajax({
                            url: '/PaymentClassify/UpRecPayType?id=' + rpguid + '&ieguid=' + ieguid + '&type=' + type + '&SumAmount=' + sumAmount,
                            type: "POST",
                            success: function (data) {
                                var res = JSON.parse(data)
                                if (res.success) {
                                    $("input[type=reset]").trigger("click");
                                    document.getElementById("WCRecordAdd").style.display = "none";
                                    $('#amyModal').modal('hide');
                                    $("#PayList").bootstrapTable('refresh', { url: "/PaymentClassify/GetPaymentList" });
                                    alert("计入成功");
                                }
                            },
                            error: function (request) {
                                alert("计入失败");
                            }
                        });
                    } else {
                        alert("计入失败");
                    }
                }
            });
        }
        if (type == '税费') {

            $("#TaxRecordAdd #SumAmount1").val($("#TaxRecordAdd #SumAmount").val());
            var sumAmount = $("#TaxRecordAdd #SumAmount").val();
            var gName = $("#TaxRecordAdd #IEGroup").val();
            if (gName == '企业所得税') {
                $('#TaxRecordAdd #Profit_GUID').val('082CD9EB-9947-43C4-A7C6-F2B7FAB6EE54');
            } else {
                $('#TaxRecordAdd #Profit_GUID').val('51BFDD3E-2253-4FBF-A946-19C18C25C6FC')
            }
            var affDate3 = $("#Expense_Form1 #AffirmDate").val();
            var RepDate = affDate3.substr(0, 7);
            //判断是否结账
            $.ajax({
                url: "/IncomeStatement/isCheckout?RepDate=" + RepDate + "&status=已结账",
                type: "POST",
                async: false,
                success: function (data) {
                    if ($.parseJSON(data).Result) {

                    } else {
                        alert("该月账单已结账，如需操作请先反结账该月账单！");
                        r = false;
                    }
                },
                error: function () {
                    alert("服务器异常");
                }
            });
            if (!r) return false;
            $.ajax({
                cache: true,
                type: "POST",
                url: "/ExpenseRecord/UpdExpenseRecord",
                data: $('#Expense_Form1').serialize(),
                async: false,
                onSubmit: function () {
                    return $("#Expense_Form1").form('validate');
                },
                error: function (request) {
                    alert("Connection error");
                },
                success: function (data) {
                    var rs = JSON.parse(data);
                    if (rs.success == true) {
                        var row = $('#PayList').bootstrapTable("getSelections");
                        var rpguid = row[0].RP_GUID;
                        var ieguid = $("#TaxRecordAdd #IE_GUID").val();
                        $.ajax({
                            url: '/PaymentClassify/UpRecPayType?id=' + rpguid + '&ieguid=' + ieguid + '&type=' + type + '&SumAmount=' + sumAmount,
                            type: "POST",
                            success: function (data) {
                                var res = JSON.parse(data)
                                if (res.success) {
                                    $("input[type=reset]").trigger("click");
                                    document.getElementById("TaxRecordAdd").style.display = "none";
                                    $('#amyModal').modal('hide');
                                    $("#PayList").bootstrapTable('refresh', { url: "/PaymentClassify/GetPaymentList" });
                                    alert("计入成功");
                                }
                            },
                            error: function (request) {
                                alert("计入失败");
                            }
                        });
                    } else {
                        alert("计入失败");
                    }
                }
            });
        }

    }
    //下一页
    function Next() {
        if ($("#IncomeGroup input[name='Type']:checked").val() == "经营活动付款") {
            document.getElementById("r1").style.display = "block";
            document.getElementById("IncomeGroup").style.display = "none";
            document.getElementById("r2").style.display = "none";
            document.getElementById("r3").style.display = "none";
        }
        if ($("#IncomeGroup input[name='Type']:checked").val() == "投资活动付款") {
            document.getElementById("r2").style.display = "block";
            document.getElementById("IncomeGroup").style.display = "none";
            document.getElementById("r1").style.display = "none";
            document.getElementById("r3").style.display = "none";
        }
        if ($("#IncomeGroup input[name='Type']:checked").val() == "筹资活动付款") {
            document.getElementById("r3").style.display = "block";
            document.getElementById("IncomeGroup").style.display = "none";
            document.getElementById("r1").style.display = "none";
            document.getElementById("r2").style.display = "none";
        }
    }
    //返回
    function Back() {
        document.getElementById("IncomeGroup").style.display = "block";
        document.getElementById("r1").style.display = "none";
        document.getElementById("r2").style.display = "none";
        document.getElementById("r3").style.display = "none";
    }
    function DeleteClick(value, RepDate) {
        //判断是否结账
        $.ajax({
            url: "/IncomeStatement/isCheckout?RepDate=" + RepDate + "&status=已结账",
            type: "POST",
            success: function (data) {
                if ($.parseJSON(data).Result) {
                    if (confirm('确认删除?')) {
                        $.ajax({
                            cache: false,
                            type: "POST",
                            url: "/PaymentClassify/DelPaymentRecord",
                            //dataType: "json",
                            data: { "id": value },
                            success: function (data) {
                                alert("删除成功");
                            },
                            error: function (data) {
                                alert("删除失败");
                            }
                        });
                    }
                    $('#PayList').bootstrapTable("refresh");
                } else {
                    alert("该月账单已结账，如需操作请先反结账该月账单！");
                    return false;
                }
            },
            error: function () {
                alert("服务器异常");
            }
        });


    }
    var rr;
    function EditClick(value) {
        var bankaccount1
        $.ajax({
            url: "/InternalAPI/GetBankAccountss",
            async: false,
            dataType: "json",
            success: function (d) {

                bankaccount1 = d;
            }
        });
        $('#PRBankAccount').multiselect({
            buttonWidth: '100%',
            maxHeight: '100%',
            enableFiltering: true,
            includeFilterNewBtn: false,
            nonSelectedText: ''

        });

        $("#PRBankAccount").multiselect('dataprovider', bankaccount1);
        $("#PRBankAccount").val("").multiselect("refresh");
        $('#Editdialog').modal({ show: true, backdrop: 'static' });
        $(".boxed-layout").css("padding-right", "0px");
        $('#Editdialog').draggable();
        var rpername;
        var payeeId;

        $.ajax({
            cache: false,
            type: "POST",
            url: "/PaymentClassify/GetPaymentRecord",
            //dataType: "json",
            data: { "id": value},
            success: function (data) {
            var obj = JSON.parse(data);
            rr = obj.rows[0];
            rpername = rr.R_PerName;
            payeeId = rr.RPer;
            $("#autocomplete2").val(rpername);
            $("#Log2").val(payeeId);
           
            $('#PRBankAccount').multiselect('select', rr.BA_GUID);
            $('#PRCurrency').multiselect('select', rr.Currency);
            $('#amt').val(rr.SumAmount);
            $('#Remark').val(rr.Remark);
            $('#payDate').val(rr.DateS);
            $('#payDate').datepicker('update');
            $('#Editdialog #GUID').val(rr.RP_GUID);
            },
        });

        $('#PayList').bootstrapTable("refresh");
         
     }

     function editRe(){
         var currency = $("#PRCurrency").val();
         var bankAccount = $("#PRBankAccount").val();
         var amt = ($('#amt').val()).replace(",", "");
         var remark=  $('#Remark').val();
         var payDate = $('#payDate').val();
         var pName = $("#autocomplete2").val();
         var pGUID = $("#Log2").val();
        
         var rper;

            $.ajax({
                url: "/InternalAPI/GetPayeeJson",
                async: false,
                dataType: "json",
                success: function (d) {
                    for (var i = 0; i < d.length; i++) {
                        d[i]["id"] = d[i]["value"];
                        d[i]["value"] = d[i]["label"];
                    }
                    rper = d;
                }
            });
         var log = $('#Log2').val();
          var log_a = "";
            for (var j = 0; j < rper.length; j++) {//通过length属性获取数组长度，循环遍历数组元素
                if (rper[j]["id"] == log) {//通过==比较数组元素是否和变量a的值相等
                    log_a = 1;
                }
            }
            if (log_a != 1) {
                $('#Log2').val("");
            }
         /////////新增编辑
            var RepDate = payDate.substr(0, 7);
         //判断是否结账
            $.ajax({
                url: "/IncomeStatement/isCheckout?RepDate=" + RepDate + "&status=已结账",
                type: "POST",
                success: function (data) {
                    if ($.parseJSON(data).Result) {
                        $.ajax({
                            cache: false,
                            type: "POST",
                            url: "/PaymentClassify/UpEditPayRecord",
                            data: {
                                RP_GUID: rr.RP_GUID, Log: pName, RPer: $("#Log2").val(), Date: payDate, BA_GUID: bankAccount,
                                Currency: currency, SumAmount: $('#amt').val(), Remark: remark, B_GUID: $('#PRBankAccount').text()
                            },
                            success: function (data) {
                                alert("编辑成功");
                                $('#PayList').bootstrapTable("refresh");
                            },
                        });
                    } else {
                        alert("该月账单已结账，如需操作请先反结账该月账单！");
                        return false;
                    }
                },
                error: function () {
                    alert("服务器异常");
                }
            });
         
     }
   
    function ShowRecord(){
      $('#aTable').bootstrapTable('destroy'); 
      var div_array = document.getElementsByName("bt");
        for(i=0;i<div_array.length;i++)
        {
        div_array[i].style.display = "none";
        }
      var Type = $("input[name='Type']:checked").val();
      var TypeDts = $("input[name='TypeDts']:checked").val();
      if(TypeDts == undefined){
         alert("请先选择付款类别!");
      }
      else{
        document.getElementById("model_table").style.display = "block";
        document.getElementById("r3").style.display = "none";
        document.getElementById("IncomeGroup").style.display = "none";
        document.getElementById("r1").style.display = "none";
        document.getElementById("r2").style.display = "none";
       
       if (TypeDts == "购买商品、接受服务所支付的款") {
            document.getElementById("b1").style.display = "block";
//         url ='/PaymentRecord/GetUnionList?customer=' + name;
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('营业成本') + "&customer="+ name;
        }else if(TypeDts == "支付管理费用"){
            document.getElementById("b12").style.display = "block";
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('管理费用') + "&customer="+ name;
        }else if(TypeDts == "支付财务费用"){
            document.getElementById("b10").style.display = "block";
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('财务费用') + "&customer="+ name;
        }else if(TypeDts == "支付销售费用"){
            document.getElementById("b13").style.display = "block";
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('销售费用') + "&customer="+ name;
        }
        else if(TypeDts == "支付其他业务成本"){
            document.getElementById("b14").style.display = "block";
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('其他业务成本') + "&customer="+ name;
        }else if(TypeDts == "支付营业外支出"){
            document.getElementById("b15").style.display = "block";
            url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('营业外支出') + "&customer="+ name;
        }
         else if (TypeDts == "支付押金") {
             document.getElementById("b2").style.display = "block";          
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('支付押金') + "&customer="+ name;
        }else if (TypeDts == "支付暂支借款") {
             document.getElementById("b17").style.display = "block";          
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('支付暂支借款') + "&customer="+ name;
        }else if (TypeDts == "归还其它公司支付的押金") {
             document.getElementById("b18").style.display = "block";          
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('归还其它公司支付的押金') + "&customer="+ name;
        }  else if (TypeDts == "预付供应商账款") {
             document.getElementById("b4").style.display = "block";          
            url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('预付供应商账款') + "&customer="+ name;
        }
        else if (TypeDts == "支付其他与经营活动有关的款") {
             document.getElementById("b11").style.display = "block";
             url = '/PaymentRecord/GetUnionList?customer=' + name + "&InvType=" + escape('财务费用');
        } else if (TypeDts == "短期投资支出") {
             document.getElementById("b6").style.display = "block";
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('短期投资支出') + "&customer="+ name;
        } else if (TypeDts == "长期股权投资支出") {
             document.getElementById("b21").style.display = "block";
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('长期股权投资支出') + "&customer="+ name;
        } else if (TypeDts == "长期债券投资支出") {
             document.getElementById("b22").style.display = "block";
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录') + "&incomeGrp=" + escape('长期债券投资支出') + "&customer="+ name;
        } else if (TypeDts == "购买固定资产所支付的款") {
            document.getElementById("b7").style.display = "block";
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('固定资产') + "&customer="+ name;
        } else if (TypeDts == "购买无形资产所支付的款") {
            document.getElementById("b19").style.display = "block";
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('无形资产') + "&customer="+ name;
        }else if (TypeDts == "购买其他长期资产所支付的款") {
            document.getElementById("b20").style.display = "block";
            url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('其他长期资产') + "&customer="+ name;
        }else if (TypeDts == "归还短期借款所支付的款") {
          document.getElementById("b8").style.display = "block";  
          url = '/ReceivablesDeclareCustomer/ChooseReceivablesDeclareCustomerList?record='+ escape('未还款')+"&flag="+"P"+ "&customer="+ name;
        } else if (TypeDts == "归还长期借款所支付的款") {
          document.getElementById("b23").style.display = "block";  
          url = '/ReceivablesDeclareCustomer/ChooseReceivablesDeclareCustomerList?record='+ escape('未还款')+"&flag="+"P"+ "&customer="+ name;
        } else if (TypeDts == "分配利润、股利所支付的款") {
             document.getElementById("b9").style.display = "block";    
             url = '/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付') + "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('分配利润、股利所支付的款') + "&customer="+ name;
        }else if (TypeDts == "偿付利息所支付的款") {
            document.getElementById("b16").style.display = "block";
             url ='/PaymentDeclareCostSpending/GetPaymentDeclareCostSpendingList?state=' + escape('未付')+ "&Record=" + escape('未记录')+ "&incomeGrp=" + escape('偿付利息所支付的款') + "&customer="+ name;
        }else if (TypeDts == "支付职工薪酬") {
            document.getElementById("b3").style.display = "block";
            url = '/WageCostsRecord/GetWageCostList?state=' + escape('未付');
        } else if (TypeDts == "支付的各项税费") {
             document.getElementById("b5").style.display = "block";
             url ='/PaymentRecord/GetChoosePayablesList?state=' + escape('应付')+"&invtype="+escape('税费');
        }
           
            var columns = new Array();
            columns.push({ field: 'ck', checkbox: true, title: '选择', width: '50' });
           
            columns.push({ field: 'RPerName', title: '@FMS.Resource.Finance.Finance.Payee', align: 'center' });
            
            columns.push({ field: 'InvType', title: '付款类别', align: 'center' });
              columns.push({ field: 'Amount', title: '@FMS.Resource.Finance.Finance.Payment@FMS.Resource.Finance.Finance.Amount', align: 'center', formatter: DecimalFmter });
            
            if(arr1.indexOf(TypeDts)>-1){
                 columns.push({ field: 'IEGroup', title: '详细类别',align: 'center' });
                columns.push({ field: 'IE_GUID', title: '未销金额', formatter:LinkHandleResidualAmount,align: 'center' });
                columns.push({ field: 'InvNo', title: '@FMS.Resource.Finance.Finance.InvNo', align: 'center' });
            }if(arr2.indexOf(TypeDts)>-1){
          
                columns.push({ field: 'GUID', title: '未销金额', formatter: LinkHandleResidualAmount, align: 'center' });
                columns.push({ field: 'VoucherNo', title: '@FMS.Resource.Finance.Finance.InvNo', align: 'center' });
            }
            if(TypeDts== "归还债务所支付的款"){
                 columns.push({ field: 'GUID', title: '未销金额', formatter: LinkHandleResidualAmount, align: 'center' });
                columns.push({ field: 'InvNo', title: '@FMS.Resource.Finance.Finance.InvNo', align: 'center' });
            }
            $('#aTable').bootstrapTable('destroy'); 
            $('#aTable').bootstrapTable({
                url: url,
                method: 'get',
                pageSize: 5,
                pageList: [5, 10, 25, 50, 100, 200], // 自定义分页列表
                pageNumber: 1,
                singleSelect: true,
                clickToSelect: true,
                checkOnSelect: true,
                selectOnCheck: true,
                pagination: true,
                sortName: 'AffirmDate', // 设置默认排序为 name
                sortOrder: 'desc', // 设置排序为反序 desc
                search: false,
                showColumns: true,
                showRefresh: false,
                showQuery: false,
                showToggle: false,
                showExport: false,
                exportTypes: ['xml', 'txt', 'excel'],
                columns: columns,
	            onCheck: function (row) {
                 var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord.length!=0){
		          document.getElementById("button4").removeAttribute('disabled');
                  }else{
                  document.getElementById("button4").removeAttribute('disabled');
                  }
	            },
                onUncheck: function (row) {
                  var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord != 0){
                 document.getElementById("button4").removeAttribute('disabled');
		       
	            }else{
                 document.getElementById("button4").disabled  = "true";
                }
                },
                onCheckAll: function (row) {
                  var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord != 0){
                 document.getElementById("button4").removeAttribute('disabled');
		       
	            }else{
                 document.getElementById("button4").disabled  = "true";
                }
                },
                onUncheckAll: function (row) {
                  var ierecord = $('#aTable').bootstrapTable("getSelections");
                 if(ierecord != 0){
                 document.getElementById("button4").removeAttribute('disabled');
		       
	            }else{
                 document.getElementById("button4").disabled  = "true";
                }
                }
            });
          }
    }


    function RSubmit(){
      var Type
      var TypeDts
      var rows = $('#PayList').bootstrapTable("getSelections");
      var ierecord = $('#aTable').bootstrapTable("getSelections");
      if(rows[0].InvTypeDts!==null){
      Type = rows[0].InvType;
      TypeDts = rows[0].InvTypeDts;
      }else{
        Type =  $("input[name='Type']:checked").val();
        TypeDts = $("input[name='TypeDts']:checked").val();
      }
      var list = new Array();
      var pay;
      var rpguid;
      var ieguid;
      var guid;
      var sumAmount = 0;
      var disAmount= 0;
      var param = new Array();
      
       if (ierecord.length == 0) {
            alert("请选择成本与费用记录！");
        }
        else{
        if(arr1.indexOf(TypeDts)>-1){
              
            $.each(rows, function (index, item1) {
            rpguid = item1.RP_GUID;
            sumAmount = item1.DisAmount;
            $.each(ierecord, function (index, item) {
                    disAmount  = disAmount +item.DisAmount;
                    });
                    var tempMap={};
                     for(var i=0;i<ierecord.length;i++){
                        var obj = ierecord[i];
                        var key = obj["TypeDts"];
                        if(tempMap[key]!=0&&!tempMap[key]){
                            tempMap[key]=obj["IE_GUID"];
              
                        }else{
                            tempMap[key]=tempMap[key]+","+obj["IE_GUID"];
              
                        }   
                        var key = obj["InvType"];
                        if(tempMap[key]!=0&&!tempMap[key]){
                            tempMap[key]=obj["IE_GUID"];
              
                        }else{
                            tempMap[key]=tempMap[key]+","+obj["IE_GUID"];
              
                        }   




                    }
                ieguid =  tempMap[key];
                pay = new Object;
                pay.DisAmount = disAmount;
                pay.RP_GUID = rpguid;
                pay.IE_GUID = ieguid;
                pay.InvTypeDts = TypeDts;
                pay.InvType = Type;
                pay.SumAmount = sumAmount;
                pay.Mark = "IE";
                list.push(pay);
          });
           param = {payList:list,SumAmount:sumAmount,DisAmount:disAmount};
            
                 $.ajax({
	                   url: "/PaymentWrite/UpdPayInyType",
	                    type: "POST",
                        async: false,
                        contentType: 'application/json',
                        dataType: 'html',
                        data: JSON.stringify(param),
                        success:function(data){
                        var rs = JSON.parse(data);
                            if(rs.Result ==true){
                           alert("销账成功");
                           }else{
                            alert("销账金额不匹配");
                           }
                             location.reload(true);
                         }
                     
	                });
                  
            }else if(arr2.indexOf(TypeDts)>-1){
            $.each(rows, function (index, item1) {
            rpguid = item1.RP_GUID;
            sumAmount = item1.DisAmount;
       $.each(ierecord, function (index, item) {
       disAmount  = disAmount +item.DisAmount;
          });
             var tempMap={};
                         for(var i=0;i<ierecord.length;i++){
                        var obj = ierecord[i];
                        var key = obj["TypeDts"];
                        var key = obj["InvType"];
                        if(tempMap[key]!=0&&!tempMap[key]){
                            tempMap[key]=obj["IE_GUID"];
              
                        }else{
                            tempMap[key]=tempMap[key]+","+obj["IE_GUID"];
              
                        }   
                        if(tempMap[key]!=0&&!tempMap[key]){
                            tempMap[key]=obj["GUID"];
              
                        }else{
                            tempMap[key]=tempMap[key]+","+obj["GUID"];
              
                        }   
                    }
                
                guid = tempMap[key];
                pay = new Object;
                pay.RP_GUID = rpguid;
                pay.IE_GUID = guid;
                pay.InvTypeDts = TypeDts;
                pay.InvType = Type;
                pay.DisAmount  = disAmount;
                pay.SumAmount = sumAmount;
                pay.Mark = "DS";
                 
                list.push(pay);
                
                });
               
        
           param = {payList:list,SumAmount:sumAmount,DisAmount:disAmount};
             
             
            
                 $.ajax({
	                   url: "/PaymentWrite/UpdPayInyType",
	                    type: "POST",
                        async: false,
                        contentType: 'application/json',
                        dataType: 'html',
                        data: JSON.stringify(param),
                        success:function(data){
                        var rs = JSON.parse(data);
                            if(rs.Result ==true){
                           alert("销账成功");
                           }else{
                            alert("销账金额不匹配")
                           }
                              location.reload(true);
                         }
                   
	                });
                  
               
         }else if(TypeDts == "支付职工或为职工支付的款"){
                $.each(rows, function (index, item1) {
            rpguid = item1.RP_GUID;
            sumAmount = item1.DisAmount;
       $.each(ierecord, function (index, item) {
        sumAmount = item1.DisAmount;
       if(item.Employee !== item1.Remark){
            alert("员工名不匹配");
        }
         });
         var tempMap={};
                         for(var i=0;i<ierecord.length;i++){
                        var obj = ierecord[i];
                        var key = obj["TypeDts"];
                        if(tempMap[key]!=0&&!tempMap[key]){
                            tempMap[key]=obj["W_GUID"];
              
                        }else{
                            tempMap[key]=tempMap[key]+","+obj["W_GUID"];
              
                        }   
                    }
                ieguid = item.W_GUID;
                pay = new Object;
                pay.RP_GUID = rpguid;
                pay.IE_GUID = ieguid;
                pay.InvTypeDts = TypeDts;
                pay.InvType = Type;
                pay.DisAmount  = disAmount;
                pay.SumAmount = sumAmount;
                pay.Mark = "IE";
                list.push(pay);
         
           param = {payList:list,SumAmount:sumAmount,DisAmount:disAmount};
            
                 $.ajax({
	                   url: "/PaymentWrite/UpdPayInyType",
	                    type: "POST",
                        async: false,
                        contentType: 'application/json',
                        dataType: 'html',
                        data: JSON.stringify(param),
                        success:function(data){
                        var rs = JSON.parse(data);
                            if(rs.Result ==true){
                           alert("销账成功");
                           }else{
                            alert("销账金额不匹配");
                           }
                             location.reload(true);
                         }
                     
	                });
                     });
            }
            else if(TypeDts == "归还债务所支付的款"){
                $.each(rows, function (index, item1) {
            rpguid = item1.RP_GUID;
              sumAmount = item1.DisAmount;
       $.each(ierecord, function (index, item) {
             disAmount  = disAmount +item.DisAmount1;
        });
         var tempMap={};
                         for(var i=0;i<ierecord.length;i++){
                        var obj = ierecord[i];
                        var key = obj["TypeDts"];
                        if(tempMap[key]!=0&&!tempMap[key]){
                            tempMap[key]=obj["GUID"];
              
                        }else{
                            tempMap[key]=tempMap[key]+","+obj["GUID"];
              
                        }   
                    }
                ieguid = tempMap[key];
                pay = new Object;
                pay.RP_GUID = rpguid;
                pay.IE_GUID = ieguid;
                pay.InvTypeDts = TypeDts;
                pay.InvType = Type;
                pay.DisAmount  = disAmount;
                pay.SumAmount = sumAmount;
                pay.Mark = "DCP";
                list.push(pay);
          });
           param = {payList:list,SumAmount:sumAmount,DisAmount:disAmount};
            
                 $.ajax({
	                   url: "/PaymentWrite/UpdPayInyType",
	                    type: "POST",
                        async: false,
                        contentType: 'application/json',
                        dataType: 'html',
                        data: JSON.stringify(param),
                        success:function(data){
                        var rs = JSON.parse(data);
                            if(rs.Result ==true){
                           alert("销账成功");
                           }else{
                            alert("销账金额不匹配");
                           }
                             location.reload(true);
                         }
                     
	                });
            }else if(TypeDts == "支付的各项税费") {
            $.each(rows, function (index, item1) {
                rpguid = item1.RP_GUID;
                var tempMap = {};
                for (var i = 0; i < ierecord.length; i++) {
                    var obj = ierecord[i];
                    //var key = obj["InvType"];
                    var key = obj["IEGroup"];
                    if (tempMap[key] != 0 && !tempMap[key]) {
                        tempMap[key] = obj["IE_GUID"];

                    } else {
                        tempMap[key] = tempMap[key] + "," + obj["IE_GUID"];
                    }
                }

                for (key in tempMap) {
                    var detailTax;
                    sumAmount = 0;
                    aa = key.split(',');
                    IErecord = tempMap[key].split(',');
                    var param = IErecord.join("','");
                    console.log(param);
                    $.ajax({
                        url: "/TaxProvisionRecord/GetTaxDetailInfoByRecID?strPar=" + rpguid + "&taskDetailID=" + param,
                        async: false,
                        dataType: "json",
                        success: function (d) {
                            detailTax = d;
                        }
                    });
                    for (var i = 0; i < detailTax.length; i++) {
                        pay = new Object;
                        disAmount += parseInt(detailTax[i]["DisAmount"]);
                        pay.B_GUID = item1.B_GUID;
                        pay.DisAmount = detailTax[i]["DisAmount"];
                        pay.RP_GUID = rpguid;
                        pay.IE_GUID = detailTax[i]["GUID"];
                        pay.InvTypeDts = TypeDts;
                        pay.InvType = Type;
                        pay.SumAmount = item1.SumAmount;
                        pay.Mark = "TA";
                        sumAmount += item1.SumAmount;
                        list.push(pay);
                    }
                }
            });
            param = { payList: list, SumAmount: sumAmount, DisAmount: disAmount };

            $.ajax({
                url: "/PaymentWrite/UpdPayInyType",
                type: "POST",
                async: false,
                contentType: 'application/json',
                dataType: 'html',
                data: JSON.stringify(param),
                success: function (data) {
                    var rs = JSON.parse(data);
                    if (rs.Result == true) {
                        alert("销账成功");
                    } else {
                        alert("销账金额不匹配");
                    }
                    location.reload(true);
                }

            });
}

        }
       
     
    }

    function SubmitType() {
        var rows = $('#PayList').bootstrapTable("getSelections");
        var Type = $("input[name='Type']:checked").val();
        var TypeDts = $("input[name='TypeDts']:checked").val();
        $.each(rows, function (index, item) {
            id = item.RP_GUID;
            record = item.Record;
        });
        if (TypeDts == "购买商品、接受服务所支付的款") {
            cfitemguid = "0526C862-F238-4301-A198-E7EC83A645D5";
        } else if (TypeDts == "支付押金、暂支款") {
            cfitemguid = "DE7D81B9-680B-4011-A771-C8B327A549F8";
        } else if (TypeDts == "支付经营活动有关预付供应商款") {
            cfitemguid = "DE7D81B9-680B-4011-A771-C8B327A549E7";
        } else if (TypeDts == "投资所支付款") {
            cfitemguid = "049F1C6D-49EA-4E2D-93FD-2DABEBED666C";
        } else if (TypeDts == "购买固定资产、无形资产和其他长期资产所支付的款") {
            cfitemguid = "EA46CFA0-5D41-4FF1-9BF8-9A36CB8F1F11";
        } else if (TypeDts == "归还债务所支付的款") {
            cfitemguid = "3229c892-e140-4690-8d25-3469a0029e04";
        } else if (TypeDts == "分配股利、利润的款") {
            cfitemguid = "d92b41c2-6349-4ad6-90a5-1b90659cf6a8";
        } else if (TypeDts == "偿付利息所支付的款") {
            cfitemguid = "f0bc0c06-dcfc-4488-96c1-2a61fb5d73d5";
        } else if (TypeDts == "支付职工或为职工支付的款") {
            cfitemguid = "e7b790cf-73f8-4946-8010-4dbf84a2fa6d";
        } else if (TypeDts == "支付的各项税费") {
            cfitemguid = "e0175cc7-647d-4241-9ddb-c216891e43e4";
        }
        $('#PayList').bootstrapTable('refresh', { url: "/PaymentClassify/UpdPayInyType?id=" + id + "&invtype=" + Type + "&typedts=" + TypeDts + "&cfitemguid=" + cfitemguid + "&record=" + record });
        $('#amyModal').modal('hide');
        $('#PayList').bootstrapTable('refresh', { url: "/PaymentClassify/GetPaymentList" });
        location.reload(true);
    }

    //提交
    function Submit(obj) {
        if ($("input[name='TypeDts']:checked").val() == "购买商品、接受服务所支付的款") {
            var url;
            var columns = new Array();
            columns.push({ field: 'ck', checkbox: true, title: '选择', width: '50' });
            url = "/ExpenseQuery/GetExpenseList";
            columns.push({ field: 'RPerName', title: '@FMS.Resource.Finance.Finance.Payee', align: 'center' });
            columns.push({ field: 'InvNo', title: '@FMS.Resource.Finance.Finance.InvNo', align: 'center' });
            columns.push({ field: 'InvType', title: '收入类别', align: 'center' });
            columns.push({ field: 'Money', title: '@FMS.Resource.Finance.Finance.Proceeds@FMS.Resource.Finance.Finance.Amount', align: 'center', formatter: DecimalFmter });
            $('#aTable').bootstrapTable({
                url: url,
                method: 'get',
                pageSize: 5,
                pageList: [5, 10, 25, 50, 100, 200], // 自定义分页列表
                pageNumber: 1,
                clickToSelect: true,
                checkOnSelect: true,
                selectOnCheck: true,
                pagination: true,
                sortName: 'AffirmDate', // 设置默认排序为 name
                sortOrder: 'desc', // 设置排序为反序 desc
                search: false,
                showColumns: true,
                showRefresh: false,
                showQuery: false,
                showToggle: false,
                showExport: false,
                exportTypes: ['excel'],
                columns: columns
            });
            document.getElementById("model_table").style.display = "block";
            document.getElementById("r3").style.display = "none";
            document.getElementById("IncomeGroup").style.display = "none";
            document.getElementById("r1").style.display = "none";
            document.getElementById("r2").style.display = "none";
            //$("<div id='CancelExpenseRecordDiv'></div>").dialog({
            //    title: '应付帐明细',
            //    width: 800,
            //    height: 497,
            //    onClose: function () {
            //        $("#CancelExpenseRecordDiv").dialog("destroy");
            //    },
            //    buttons: [
            //        {
            //            text: '销账',
            //            handler: function () { CheckAmount(); }
            //        }
            //    ]
            //});
            //$('#CancelExpenseRecordDiv').dialog("refresh", "/PaymentClassify/CancelExpenseRecord");
        }

        if ($("input[name='TypeDts']:checked").val() == "支付的其他与经营活动有关的款预付供应商、支付押金、暂支款等") {
            var id;
            var name;
            var date;
            var money;
            var cur;
            $("#PR_List").after('<div id="CancelRecordOne"></div>');

            $("#CancelRecordOne").dialog({
                title: '详细归账',
                closed: true,
                width: 250,
                height: 300,
                onClose: function () {
                    $("#CancelRecordOne").dialog("destroy");
                },
                buttons: [
	                {
	                    text: '提交',
	                    handler: function () { CheckOne(); }
	                }
                ]
            });
            var rows = $('#PR_List').datagrid('getChecked');
            $.each(rows, function (index, item) {
                id = item.RP_GUID;
                name = item.R_PerName;
                date = item.Date;
                money = item.SumAmount;
                cur = item.Currency;
            });
            $("#CancelRecordOne").dialog("open");
            $('#CancelRecordOne').dialog("refresh", "/PaymentClassify/CancelRecordOne?Guid=" + id + "&Name=" + name + "&Date=" + date + "&Money=" + money + "&Cur" + cur);
        }
        if ($("input[name='TypeDts']:checked").val() == "支付的各项税费") {
            $("<div id='CancelRecordTwo'></div>").dialog({
                title: '应付税费明细',
                width: 800,
                height: 497,
                onClose: function () {
                    $("#CancelRecordTwo").dialog("destroy");
                },
                buttons: [
	                {
	                    text: '销账',
	                    handler: function () { CheckRecordTwo(); }
	                }
                ]
            });
            $('#CancelRecordTwo').dialog("refresh", "/PaymentClassify/CancelRecordTwo");
        }

        if ($("input[name='TypeDts']:checked").val() == "支付职工或为职工支付的款") {
            $("<div id='CancelRecordThree'></div>").dialog({
                title: '应支付职工或为职工支付的款明细',
                width: 800,
                height: 497,
                onClose: function () {
                    $("#CancelRecordThree").dialog("destroy");
                },
                buttons: [
	                {
	                    text: '销账',
	                    handler: function () { CheckRecordThree(); }
	                }
                ]
            });
            $('#CancelRecordThree').dialog("refresh", "/PaymentClassify/CancelRecordThree");
        }

        if ($("input[name='TypeDts']:checked").val() == "投资所支付的款") {
            $("<div id='CancelRecordFour'></div>").dialog({
                title: '投资应付明细',
                width: 800,
                height: 497,
                onClose: function () {
                    $("#CancelRecordFour").dialog("destroy");
                },
                buttons: [
	                {
	                    text: '销账',
	                    handler: function () { CheckRecordFour(); }
	                }
                ]
            });
            $('#CancelRecordFour').dialog("refresh", "/PaymentClassify/CancelRecordFour");
        }

        if ($("input[name='TypeDts']:checked").val() == "支付的其他与投资活动有关的款") {
            $("<div id='CancelRecordFive'></div>").dialog({
                title: '支付的其他与投资活动有关的应付款明细',
                width: 800,
                height: 497,
                onClose: function () {
                    $("#CancelRecordFive").dialog("destroy");
                },
                buttons: [
	                {
	                    text: '销账',
	                    handler: function () { CheckRecordFive(); }
	                }
                ]
            });
            $('#CancelRecordFive').dialog("refresh", "/PaymentClassify/CancelRecordFive");
        }

        if ($("input[name='TypeDts']:checked").val() == "支付的其他与筹资活动有关的款") {
            $("<div id='CancelRecordFives'></div>").dialog({
                title: '支付的其他与筹资活动有关的应付款明细',
                width: 800,
                height: 497,
                onClose: function () {
                    $("#CancelRecordFives").dialog("destroy");
                },
                buttons: [
	                {
	                    text: '销账',
	                    handler: function () { CheckRecordFives(); }
	                }
                ]
            });
            $('#CancelRecordFives').dialog("refresh", "/PaymentClassify/CancelRecordFives");
        }

        if ($("input[name='TypeDts']:checked").val() == "偿还债务所支付的款") {
            $("<div id='CancelRecordSix'></div>").dialog({
                title: '偿还债务所支付的应付款明细',
                width: 800,
                height: 497,
                onClose: function () {
                    $("#CancelRecordSix").dialog("destroy");
                },
                buttons: [
	                {
	                    text: '销账',
	                    handler: function () { CheckRecordSix(); }
	                }
                ]
            });
            $('#CancelRecordSix').dialog("refresh", "/PaymentClassify/CancelRecordSix");
        }
        if ($("input[name='TypeDts']:checked").val() == "分配股利、利润和偿付利息所支付的款") {
            var id;
            var name;
            var date;
            var money;
            var cur;
            $("#PR_List").after('<div id="CancelRecordSeven"></div>');

            $("#CancelRecordSeven").dialog({
                title: '详细归账',
                closed: true,
                width: 250,
                height: 300,
                onClose: function () {
                    $("#CancelRecordSeven").dialog("destroy");
                },
                buttons: [
                {
                    text: '提交',
                    handler: function () { CheckRecordSeven(); }
                }
                ]
            });
            var rows = $('#PR_List').datagrid('getChecked');
            $.each(rows, function (index, item) {
                id = item.RP_GUID;
                name = item.R_PerName;
                date = item.Date;
                money = item.SumAmount;
                cur = item.Currency;
            });
            $("#CancelRecordSeven").dialog("open");
            $('#CancelRecordSeven').dialog("refresh", "/PaymentClassify/CancelRecordSeven?Guid=" + id + "&Name=" + name + "&Date=" + date + "&Money=" + money + "&Cur" + cur);
        }

        if ($("input[name='TypeDts']:checked").val() == "购买固定资产、无形资产和其他长期资产所支付的款") {
            $("<div id='CancelRecordEight'></div>").dialog({
                title: '支付购买固定资产、无形资产和其他长期资产的应付款明细',
                width: 800,
                height: 497,
                onClose: function () {
                    $("#CancelRecordEight").dialog("destroy");
                },
                buttons: [
                {
                    text: '销账',
                    handler: function () { CheckRecordEight(); }
                }
                ]
            });
            $('#CancelRecordEight').dialog("refresh", "/PaymentClassify/CancelRecordEight");
        }
    }
    function backCancelAccount(value, RepDate, ieguid) {

        var r = confirm("确定反销账？!");
        if (r == true) {
            //判断是否结账
            $.ajax({
                url: "/IncomeStatement/isCheckout?RepDate=" + RepDate + "&status=已结账",
                type: "POST",
                success: function (data) {
                    if ($.parseJSON(data).Result) {
                        $.ajax({
                            cache: false,
                            type: "POST",
                            url: "/ReceivablesClassify/backCancelAccount",
                            //dataType: "json",
                            data: { "id": value, "flag": "P" },
                            success: function (data) {
                                alert("反销账成功");
                                location.reload(true);
                            },
                            error: function (data) {
                                alert("反销账失败");
                            }
                        });

                        $('#ReceivableList').bootstrapTable("refresh");
                    } else {
                        alert("该月账单已结账，如需操作请先反结账该月账单！");
                        return false;
                    }
                },
                error: function () {
                    alert("服务器异常");
                }
            });
        }
    }
</script>
