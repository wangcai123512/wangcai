@{
    ViewBag.Title = "";
    Layout = "~/Views/Shared/_Layout_New.cshtml";
}
<style type="text/css">
    .btn-default
    {
        background-color: #CCCC;
    }
</style>
<div id="main" style="margin-top: 100px; background-color: #FFF; padding-bottom: 20px;">
    <!-- Start: Sidebar -->
    <aside id="sidebar_left" style="font-size: 16px;">
        <div class="sidebar-menu" style="margin-top: 10px">
            <ul class="nav">
                 <li><span class="sidebar-title" style="font-size: 14px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我的公司：<a onclick="javascript:window.location = '/CompanyInformationSet/Index'" href="javascript:window.location = '/CompanyInformationSet/Index'"><span class="sidebar-title" style="font-size: 14px; color: #023A85"><b>@Session["CompanyName"]</b></span></a></span></li>
                    <li><span class="sidebar-title" style="font-size: 14px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;财务统计货币：<a onclick="javascript:window.location = '/Company/ChangeCompanySetting'" href="javascript:window.location = '/Company/ChangeCompanySetting'"><span class="sidebar-title" style="font-size: 14px;color: #023A85"><b>@Session["Currency"]</b></span></a></span></li>
                <li id="UserInfo"> <a onclick="javascript: window.location = '/UserInfo/Index'" href="javascript:window.location = '/UserInfo/Index'"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">我的属性</span></a></li>
                <li> <a onclick="javascript:window.location = '/Company/ChooseAndAddCompany'" href="javascript:window.location = '/Company/ChooseAndAddCompany'"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">新增或切换公司</span></a></li>
                <li>
                    <a class="accordion-toggle" href="#sideFour"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">财务数据设置</span></a>
                    <ul id="sideFour" class="nav sub-nav">
                        <li><a onclick="javascript:window.location = '/InitialBalanceManagement/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">科目余额初始化</span></a></li>
                        <li><a onclick="javascript:window.location = '/TaxAndTaxRateSet/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">税种与税率设置</span></a></li>
                        <li><a onclick="javascript:window.location = '/CurrencyAndExchangeRateManagement/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">货币与汇率设置</span></a></li>
                        @*<li><a onclick="javascript:window.location = '/DetailManagement/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">费用类别设置</span></a></li>*@
                        <li><a onclick="javascript:window.location = '/BusinessUnitSetting/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">业务单元设置</span></a></li>
                    </ul>
                </li>


                <li> <a onclick="javascript:window.location = '/GeneralLedgerAccount/GeneralLedger'" href="javascript:window.location = '/GeneralLedgerAccount/GeneralLedger'"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">设置会计科目</span></a></li>
                <li>
                    <a class="accordion-toggle" href="#sideVoucher"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">科目查询</span></a>
                    <ul id="sideVoucher" class="nav sub-nav">
                        <li><a onclick="javascript: window.location = '/InitialBalanceManagement/Search'" href="javascript:window.location = '/InitialBalanceManagement/Search'"><span class="sidebar-title" style="font-size: 14px">科目流水查询</span></a></li>
                        <li><a onclick="javascript: window.location = '/InitialBalanceManagement/BalanceSearch'" href="javascript:window.location = '/InitialBalanceManagement/BalanceSearch'"><span class="sidebar-title" style="font-size: 14px">科目余额查询</span></a></li>
                        @*<li><a href="#"><span class="sidebar-title" style="font-size: 14px">科目余额</span></a></li>*@
                    </ul>
                </li>
                <li>
                    <a class="accordion-toggle" href="#sidecompany"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">公司登记</span></a>
                    <ul id="sidecompany" class="nav sub-nav">
                        <li> <a onclick="javascript: window.location = '/BusinessPartnerSetting/BusinessPartner'" href="javascript:window.location = '/BusinessPartnerSetting/BusinessPartner'"><span class="sidebar-title" style="font-size: 14px">往来公司登记</span></a></li>
                        <li> <a onclick="javascript: window.location = '/BusinessPartnerSetting/Index'" href="javascript:window.location = '/BusinessPartnerSetting/Index'"><span class="sidebar-title" style="font-size: 14px">往来公司查询</span></a></li>
                    </ul>
                </li>
                
                <li>
                    <a class="accordion-toggle menu-open" href="#sideTwo"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">用户管理</span></a>
                    <ul id="sideTwo" class="nav sub-nav">
                        <li><a onclick="javascript:window.location = '/UserManagement/AddUser'" href="#"><span class="sidebar-title" style="font-size: 14px">增加新用户</span></a></li>
                        <li><a onclick="javascript:window.location = '/UserManagement/UserList'" href="#"><span class="sidebar-title" style="font-size: 14px">变更用户权限</span></a></li>
                        <li class="active"><a onclick="javascript:window.location = '/UserManagement/ExchangeManager'" href="#"><span class="sidebar-title" style="font-size: 14px; color: #08C">变更管理者</span></a></li>
                        <li><a onclick="javascript:window.location = '/Company/EditUser'" href="#"><span class="sidebar-title" style="font-size: 14px">修改密码</span></a></li>
                    </ul>
                </li>

                <li> <a onclick="Undone()" href=""><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">寻求会计帮助</span></a></li>
            </ul>
        </div>
    </aside>
    <!-- Start: Content -->
    <section id="content_wrapper">
        <div id="MAIN" style="background-color: #FFF">
            <div id="content">
                <div id="One" class="row" style="margin-top: 20px">
                    <div class="col-md-12" style="margin: auto">
                        <div class="col-md-12" style="margin-bottom: 0px; text-align: center"><span style="font-size: 30px; font-weight: 900; color: #074592; text-decoration: underline">变更管理者</span></div>
                        <br />
                        <br />
                        <br />
                        <div class="col-md-3" style="margin: auto"></div>
                        <div class="col-md-6" style="margin: auto">
                            <form id="Manager_Form">
                                <div class="form-group">
                                    <div class="input-group " style="margin: auto">
                                        <span class="input-group-addon" style="color: #000000">新管理者手机/邮箱</span>
                                        <input type="text" id="LoginName" name="LoginName" class="form-control" placeholder="" />
                                        <span class="input-group-addon" style="color: #000000"><input type="button" id="sendBtn" name="sendBtn" onclick="SendValidCode()" value="发送验证码" /></span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="input-group " style="margin: auto">
                                        <span class="input-group-addon" style="color: #000000">&nbsp;&nbsp;新管理者验证码&nbsp;&nbsp;&nbsp;</span>
                                        <input type="text" id="ValidateCode" name="ValidateCode" class="form-control" placeholder="" />
                                    </div>
                                </div>
                            </form>
                            <div class="form-group" style="margin: auto; text-align: center">
                                <button onclick="Submit()" type="button" style="margin-top: 20px; height: 40px; width: 20%; border-radius: 100px; font-size: 20px; border: 0px solid #c0c0c0; font-weight: bold" class="btn btn-primary">提交</button>
                                <button onclick="window.history.go(-1)" type="button" style="margin-top: 20px; height: 40px; width: 30%; border-radius: 100px; font-size: 20px; border: 0px solid #c0c0c0; font-weight: bold" class="btn btn-primary">返回上页</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
<script language="javascript" type="text/javascript">
    var InterValObj; //timer变量，控制时间
    var count = 60; //间隔函数，1秒执行
    var curCount; //当前剩余秒数
    var code = ""; //验证码
    var codeLength = 6; //验证码长度
    function Submit() {
        $.ajax({
            cache: true,
            type: "POST",
            url: "/UserManagement/ExchangeManager",
            data: $('#Manager_Form').serialize(),
            success: function (data) {
                if (data == 'success') {
                    window.location.href = "/Common/Index"; ;
                } else {
                    alert(data);
                }
            }
        });
    }
    function SendValidCode() {
        var loginName = $('#LoginName').val();
        if (CheckEmail(loginName) || CheckPhone(loginName)) {
            $.ajax({
                url: "/Common/AddValidCode?loginName=" + loginName,
                cache: true,
                type: "POST",
                error: function (data) {
                    alert(data);
                },
                success: function (data) {
                    alert(data);
                    curCount = count;
                    $("#sendBtn").attr("disabled", "true");
                    $("#sendBtn").val(+curCount + "秒再获取");
                    InterValObj = window.setInterval(SetRemainTime, 1000); //启动计时器，1秒执行一次
                   
                }
            });
        } else {
            alert('请输入正确的手机号码或邮箱');
        }
    }

    //timer处理函数
    function SetRemainTime() {
        if (curCount == 0) {
            window.clearInterval(InterValObj); //停止计时器
            $("#sendBtn").removeAttr("disabled"); //启用按钮
            $("#sendBtn").val("重新发送验证码");
            code = ""; //清除验证码。如果不清除，过时间后，输入收到的验证码依然有效    
        }
        else {
            curCount--;
            $("#sendBtn").val(+curCount + "秒再获取");
        }
    }

    function CheckEmail(input) {
        var re = /^\w+([-+.]\w+)*@@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
        return re.exec(input);
    }
    function CheckPhone(input) {
        var re = /^1[\d]{10}$/;
        return re.exec(input);
    }
</script>