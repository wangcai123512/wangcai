@{
    ViewBag.Title = "EditUser";
    Layout = "~/Views/Shared/_Layout_New.cshtml";
}

<style type="text/css">
    .btn-default
    {
        background-color: #CCCC;
    }
</style>
<div id="main" style="margin-top: 100px; background-color: #FFF; padding-bottom: 20px;">
    <!-- Start: Sidebar -->
    <aside id="sidebar_left" style="font-size: 16px;">
        <div class="sidebar-menu" style="margin-top: 10px">
            <ul class="nav">
                 <li><span class="sidebar-title" style="font-size: 14px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我的公司：<a onclick="javascript:window.location = '/CompanyInformationSet/Index'" href="javascript:window.location = '/CompanyInformationSet/Index'"><span class="sidebar-title" style="font-size: 14px; color: #023A85"><b>@Session["CompanyName"]</b></span></a></span></li>
                    <li><span class="sidebar-title" style="font-size: 14px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;财务统计货币：<a onclick="javascript:window.location = '/Company/ChangeCompanySetting'" href="javascript:window.location = '/Company/ChangeCompanySetting'"><span class="sidebar-title" style="font-size: 14px;color: #023A85"><b>@Session["Currency"]</b></span></a></span></li>
                <li id="UserInfo"> <a onclick="javascript: window.location = '/UserInfo/Index'" href="javascript:window.location = '/UserInfo/Index'"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">我的属性</span></a></li>
                <li> <a onclick="javascript:window.location = '/Company/ChooseAndAddCompany'" href="javascript:window.location = '/Company/ChooseAndAddCompany'"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">新增或切换公司</span></a></li>
                <li>
                    <a class="accordion-toggle" href="#sideFour"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">财务数据设置</span></a>
                    <ul id="sideFour" class="nav sub-nav">
                        <li><a onclick="javascript:window.location = '/InitialBalanceManagement/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">科目余额初始化</span></a></li>
                        <li><a onclick="javascript:window.location = '/TaxAndTaxRateSet/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">税种与税率设置</span></a></li>
                        <li><a onclick="javascript:window.location = '/CurrencyAndExchangeRateManagement/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">货币与汇率设置</span></a></li>
                        @*<li><a onclick="javascript:window.location = '/DetailManagement/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">费用类别设置</span></a></li>*@
                        <li><a onclick="javascript:window.location = '/BusinessUnitSetting/Index'" href="#"><span class="sidebar-title" style="font-size: 14px">业务单元设置</span></a></li>
                    </ul>
                </li>


                <li> <a onclick="javascript:window.location = '/GeneralLedgerAccount/GeneralLedger'" href="javascript:window.location = '/GeneralLedgerAccount/GeneralLedger'"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">设置会计科目</span></a></li>
                <li>
                    <a class="accordion-toggle" href="#sideVoucher"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">科目查询</span></a>
                    <ul id="sideVoucher" class="nav sub-nav">
                        <li><a onclick="javascript: window.location = '/InitialBalanceManagement/Search'" href="javascript:window.location = '/InitialBalanceManagement/Search'"><span class="sidebar-title" style="font-size: 14px">科目流水查询</span></a></li>
                        <li><a onclick="javascript: window.location = '/InitialBalanceManagement/BalanceSearch'" href="javascript:window.location = '/InitialBalanceManagement/BalanceSearch'"><span class="sidebar-title" style="font-size: 14px">科目余额查询</span></a></li>
                        @*<li><a href="#"><span class="sidebar-title" style="font-size: 14px">科目余额</span></a></li>*@
                    </ul>
                </li>
                <li>
                    <a class="accordion-toggle" href="#sidecompany"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">公司登记</span></a>
                    <ul id="sidecompany" class="nav sub-nav">
                        <li> <a onclick="javascript: window.location = '/BusinessPartnerSetting/BusinessPartner'" href="javascript:window.location = '/BusinessPartnerSetting/BusinessPartner'"><span class="sidebar-title" style="font-size: 14px">往来公司登记</span></a></li>
                        <li> <a onclick="javascript: window.location = '/BusinessPartnerSetting/Index'" href="javascript:window.location = '/BusinessPartnerSetting/Index'"><span class="sidebar-title" style="font-size: 14px">往来公司查询</span></a></li>
                    </ul>
                </li>
                
                <li>
                    <a class="accordion-toggle menu-open" href="#sideTwo"><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">用户管理</span></a>
                    <ul id="sideTwo" class="nav sub-nav">
                        <li><a onclick="javascript:window.location = '/UserManagement/AddUser'" href="#"><span class="sidebar-title" style="font-size: 14px">增加新用户</span></a></li>
                        <li><a onclick="javascript:window.location = '/UserManagement/UserList'" href="#"><span class="sidebar-title" style="font-size: 14px">变更用户权限</span></a></li>
                        <li><a onclick="javascript:window.location = '/UserManagement/ExchangeManager'" href="#"><span class="sidebar-title" style="font-size: 14px">变更管理者</span></a></li>
                        <li class="active"><a onclick="javascript:window.location = '/Company/EditUser'" href="#"><span class="sidebar-title" style="font-size: 14px; color: #08C">修改密码</span></a></li>
                    </ul>
                </li>

                <li> <a onclick="Undone()" href=""><span class="glyphicons glyphicons-chevron-right" style="font-size: 14px"></span><span class="sidebar-title" style="font-size: 14px">寻求会计帮助</span></a></li>
            </ul>
        </div>
    </aside>
    <!-- Start: Content -->
    <section id="content_wrapper">
        <div id="MAIN" style="background-color: #FFF">
            <div id="content">
                <div id="One" class="row" style="margin-top: 20px">
                    <div class="col-md-12" style="margin: auto">
                        <div class="col-md-12" style="margin-bottom: 0px; text-align: center"><span style="font-size: 30px; font-weight: 900; color: #074592; text-decoration: underline">修改密码</span></div>
                        <br />
                        <br />
                        <br />
                        <div class="col-md-3" style="margin: auto"></div>
                        <div class="col-md-6" style="margin: auto">
                            <div class="form-group">
                                <div class="input-group " style="margin: auto">
                                    <span class="input-group-addon" style="color: #000000">&nbsp;新&nbsp;密&nbsp;码&nbsp;</span>
                                    <input type="password" id="Password" name="Password" class="form-control" placeholder="8-16位,必须有字母、数字！" />
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="input-group " style="margin: auto">
                                    <span class="input-group-addon" style="color: #000000">确认密码&nbsp;</span>
                                    <input type="password" id="Password2" name="Password2" class="form-control" placeholder="" />
                                </div>
                            </div>
                            <div class="form-group" style="margin: auto; text-align: center">
                              <div class="col-md-12" style="margin: auto">
                                <div class="col-md-6" style="margin: auto">
                                    <button onclick="Submit()" type="button" style="width: 100px; border-radius: 100px; font-size: 14px; border: 0px solid #c0c0c0; font-weight: bold" class="btn btn-primary pull-right">提交</button>
                                </div>
                                <div class="col-md-6" style="margin: auto">
                                <button onclick="window.history.go(-1)" type="button" style="width: 100px; border-radius: 100px; font-size: 14px; border: 0px solid #c0c0c0; font-weight: bold" class="btn btn-primary pull-left">返回上页</button>
                               </div>
                             </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
<script language="javascript" type="text/javascript">
    function Submit() {

        var re =/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,16}$/;
        var a = re.exec($('#Password').val());
        if($('#Password').val() == ""||$('#Password').val() == null)
        {
            alert('请输入新密码');
            $('#Password2').val('');
            $('#Password').val('');
            $('#Password').focus();
        } else if ($('#Password').val().length < 8 || re.exec($('#Password').val()) == null)
         {
            alert('新密码8-16位且为数字加字母');
            $('#Password2').val('');
            $('#Password').val('');
            $('#Password').focus();
        }
        else if ($('#Password2').val() == "" || $('#Password2').val() == null) {
            alert('请输入确认密码');
            $('#Password2').val('');
//            $('#Password').val('');
            $('#Password').focus();
        } 
        else if ($('#Password').val() !== $('#Password2').val()) {
            alert('两次密码不相同');
            $('#Password2').val('');
            $('#Password').val('');
            $('#Password').focus();


        } 
        else {
            $.ajax({
                cache: true,
                type: "POST",
                url: "/Company/EditUser?newPassword=" + $('#Password').val(),
                success: function (data) {
                    if (data == '修改成功') {
                        alert('密码修改成功');
                        window.location.href = "/UserInfo/Index";
                    } else {
                        alert(data);
                    }
                }
            });
            
        }
    }

 </script>
